!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("ChatCamp",[],t):"object"==typeof exports?exports.ChatCamp=t():e.ChatCamp=t()}(window,function(){return function(e){var t={};function n(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){"use strict";var s=n(4),r=n(12),a=Object.prototype.toString;function o(e){return"[object Array]"===a.call(e)}function i(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===a.call(e)}function u(e,t){if(null!==e&&void 0!==e)if("object"!=typeof e&&(e=[e]),o(e))for(var n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===a.call(e)},isBuffer:r,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:i,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===a.call(e)},isFile:function(e){return"[object File]"===a.call(e)},isBlob:function(e){return"[object Blob]"===a.call(e)},isFunction:c,isStream:function(e){return i(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function n(n,s){"object"==typeof t[s]&&"object"==typeof n?t[s]=e(t[s],n):t[s]=n}for(var s=0,r=arguments.length;s<r;s++)u(arguments[s],n);return t},extend:function(e,t,n){return u(t,function(t,r){e[r]=n&&"function"==typeof t?s(t,n):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){e.exports=n(11)},function(e,t,n){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();var a=n(31).LOG,o=a.DEBUG,i=a.INFO,c=a.WARN,u=a.ERROR,l=a.NONE,h=(Boolean(console.assert&&"".match(/assert/)),function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"log",value:function(e,t,n,r){"object"===(void 0===e?"undefined":s(e))&&(e,e="");(new Date).toLocaleTimeString();switch(n){case o:"debug";break;case i:"info";break;case c:"warn";break;case u:"error";break;default:"log"}}},{key:"debug",value:function(e,t){this.level>=o&&this.log(e,t,o,"#888")}},{key:"info",value:function(e,t){this.level>=i&&this.log(e,t,i,"black")}},{key:"warn",value:function(e,t){this.level>=c&&this.log(e,t,c,"orange")}},{key:"error",value:function(e,t){this.level>=u&&this.log(e,t,u,"red")}}]),e}());h.prototype.level="undefined"==typeof jasmine?u:l;var d=new h;e.exports=d},function(e,t,n){"use strict";(function(t){var s=n(0),r=n(15),a={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!s.isUndefined(e)&&s.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var i,c={adapter:("undefined"!=typeof XMLHttpRequest?i=n(5):void 0!==t&&(i=n(5)),i),transformRequest:[function(e,t){return r(t,"Content-Type"),s.isFormData(e)||s.isArrayBuffer(e)||s.isBuffer(e)||s.isStream(e)||s.isFile(e)||s.isBlob(e)?e:s.isArrayBufferView(e)?e.buffer:s.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):s.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},s.forEach(["delete","get","head"],function(e){c.headers[e]={}}),s.forEach(["post","put","patch"],function(e){c.headers[e]=s.merge(a)}),e.exports=c}).call(this,n(14))},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),s=0;s<n.length;s++)n[s]=arguments[s];return e.apply(t,n)}}},function(e,t,n){"use strict";var s=n(0),r=n(16),a=n(18),o=n(19),i=n(20),c=n(6),u="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(21);e.exports=function(e){return new Promise(function(t,l){var h=e.data,d=e.headers;s.isFormData(h)&&delete d["Content-Type"];var p=new XMLHttpRequest,g="onreadystatechange",f=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in p||i(e.url)||(p=new window.XDomainRequest,g="onload",f=!0,p.onprogress=function(){},p.ontimeout=function(){}),e.auth){var _=e.auth.username||"",m=e.auth.password||"";d.Authorization="Basic "+u(_+":"+m)}if(p.open(e.method.toUpperCase(),a(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p[g]=function(){if(p&&(4===p.readyState||f)&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?o(p.getAllResponseHeaders()):null,s={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:1223===p.status?204:p.status,statusText:1223===p.status?"No Content":p.statusText,headers:n,config:e,request:p};r(t,l,s),p=null}},p.onerror=function(){l(c("Network Error",e,null,p)),p=null},p.ontimeout=function(){l(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},s.isStandardBrowserEnv()){var I=n(22),C=(e.withCredentials||i(e.url))&&e.xsrfCookieName?I.read(e.xsrfCookieName):void 0;C&&(d[e.xsrfHeaderName]=C)}if("setRequestHeader"in p&&s.forEach(d,function(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)}),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){p&&(p.abort(),l(e),p=null)}),void 0===h&&(h=null),p.send(h)})}},function(e,t,n){"use strict";var s=n(17);e.exports=function(e,t,n,r,a){var o=new Error(e);return s(o,t,n,r,a)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function s(e){this.message=e}s.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},s.prototype.__CANCEL__=!0,e.exports=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(30),o=(s=a)&&s.__esModule?s:{default:s};t.default=function(e,t){var n=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=0;s<e;s++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},s=n(25)+(new Date).getTime(),a=0,i=1,c=2,u=3,l=e.replace("ws:","http:").replace("wss:","https:");e===l&&(void 0===t?t={disableWebSocket:!0}:t.disableWebSocket=!0);var h=function(e){if(this.readyState!==a&&this.readyState!==i)return!1;var t=this;return o.default.post(l,e,{iflychat_token:s,content_type:"application/json"},function(e){e&&0!==e.length&&t.onmessage({data:e})}),!0},d={websocket:function(){var e=null;return(void 0===t||!t.disableWebSocket)&&(window.WebSocket&&(e=window.WebSocket),window.MozWebSocket&&-1===navigator.userAgent.indexOf("Firefox/6.0")&&(e=window.MozWebSocket),e?{heart:!0,transport:e}:null)},eventsource:function(){if(void 0!==t&&t.disableEventSource)return!1;if(!window.EventSource)return!1;var e=new window.EventSource(l);e.onopen=function(){n.readyState=i,n.onopen()},e.onmessage=function(e){n.onmessage(e)},e.onerror=function(){e.close(),e=void 0,n.onerror()};var n={readyState:a,send:h,close:function(){n.readyState=u,e.close(),e=void 0,n.onclose()}};return{heart:!1,transport:function(){return n}}},xhrPolling:function(){if(void 0!==t&&t.disableXHRPolling)return!1;var e,c=null;s=n(25)+(new Date).getTime();var d={readyState:a,send:h,close:function(){this.readyState=u,c&&(c.abort(),c=null),clearTimeout(e),d.onclose()},onopen:function(){},onmessage:function(){},onerror:function(){},onclose:function(){}};function p(){e=setTimeout(function(){c=o.default.get(l,function(e){if(e){if(c=null,d.readyState===a&&(d.readyState=i,d.onopen(d)),e&&0!==e.length)if("object"===(void 0===e?"undefined":r(e)))for(var t in e)d.onmessage({data:e[t]});else d.onmessage({data:e});d.readyState===i&&p()}else c=null,d.onerror()},{iflychat_token:s})},100)}return p(),{heart:!1,transport:function(){return d}}}},p=0;var g=new function(){var t,n,s=!0,r=u,o=80,l=80,h=1e4,f=!1;!function _(){if(s=!1,r=a,!(n=f?null:function(){var t=0;for(var n in d){if(p===t){var s=d[n]();if(s){var r=new s.transport(e);return r.heart=s.heart,r}p++}t++}return!1}()))return o=l,p=0,g&&g.ondisconnect(),!1;n.onopen=function(){o=l,n.heart&&(t=setInterval(function(){g.onheartbeat()},2e4)),r!==i&&(r=i,g.onopen(),f=!0)},n.onclose=function(){s||r===u||(n=null,clearInterval(t),r===c?(r=u,n=!1,g.onclose()):(r===a&&p++,(o*=2)>h&&(o=h),s=!0,setTimeout(function(){_()},o)))},n.onerror=n.onclose,n.onmessage=function(e){g.onmessage(e)}}(),this.onopen=function(){},this.onmessage=function(){},this.ondisconnect=function(){},this.onclose=function(){},this.onheartbeat=function(){},this.setURL=function(t){e=t},this.send=function(e){if(n){var t=n.send(e);return void 0===t||t}return!1},this.close=function(){r=c,n&&n.close()},this.transportType=p};return g}},function(e,t,n){"use strict";var s=n(32).default;e.exports=s},function(e,t,n){"use strict";var s=n(0),r=n(4),a=n(13),o=n(3);function i(e){var t=new a(e),n=r(a.prototype.request,t);return s.extend(n,a.prototype,t),s.extend(n,t),n}var c=i(o);c.Axios=a,c.create=function(e){return i(s.merge(o,e))},c.Cancel=n(8),c.CancelToken=n(28),c.isCancel=n(7),c.all=function(e){return Promise.all(e)},c.spread=n(29),e.exports=c,e.exports.default=c},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";var s=n(3),r=n(0),a=n(23),o=n(24);function i(e){this.defaults=e,this.interceptors={request:new a,response:new a}}i.prototype.request=function(e){"string"==typeof e&&(e=r.merge({url:arguments[0]},arguments[1])),(e=r.merge(s,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[o,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},r.forEach(["delete","get","head","options"],function(e){i.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}}),r.forEach(["post","put","patch"],function(e){i.prototype[e]=function(t,n,s){return this.request(r.merge(s||{},{method:e,url:t,data:n}))}}),e.exports=i},function(e,t){var n,s,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{s="function"==typeof clearTimeout?clearTimeout:o}catch(e){s=o}}();var c,u=[],l=!1,h=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&p())}function p(){if(!l){var e=i(d);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===o||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new g(e,t)),1!==u.length||l||i(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";var s=n(0);e.exports=function(e,t){s.forEach(e,function(n,s){s!==t&&s.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[s])})}},function(e,t,n){"use strict";var s=n(6);e.exports=function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(s("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,s,r){return e.config=t,n&&(e.code=n),e.request=s,e.response=r,e}},function(e,t,n){"use strict";var s=n(0);function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var a;if(n)a=n(t);else if(s.isURLSearchParams(t))a=t.toString();else{var o=[];s.forEach(t,function(e,t){null!==e&&void 0!==e&&(s.isArray(e)?t+="[]":e=[e],s.forEach(e,function(e){s.isDate(e)?e=e.toISOString():s.isObject(e)&&(e=JSON.stringify(e)),o.push(r(t)+"="+r(e))}))}),a=o.join("&")}return a&&(e+=(-1===e.indexOf("?")?"?":"&")+a),e}},function(e,t,n){"use strict";var s=n(0),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,a,o={};return e?(s.forEach(e.split("\n"),function(e){if(a=e.indexOf(":"),t=s.trim(e.substr(0,a)).toLowerCase(),n=s.trim(e.substr(a+1)),t){if(o[t]&&r.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([n]):o[t]?o[t]+", "+n:n}}),o):o}},function(e,t,n){"use strict";var s=n(0);e.exports=s.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var s=e;return t&&(n.setAttribute("href",s),s=n.href),n.setAttribute("href",s),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=s.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r(){this.message="String contains an invalid character"}r.prototype=new Error,r.prototype.code=5,r.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,n,a=String(e),o="",i=0,c=s;a.charAt(0|i)||(c="=",i%1);o+=c.charAt(63&t>>8-i%1*8)){if((n=a.charCodeAt(i+=.75))>255)throw new r;t=t<<8|n}return o}},function(e,t,n){"use strict";var s=n(0);e.exports=s.isStandardBrowserEnv()?{write:function(e,t,n,r,a,o){var i=[];i.push(e+"="+encodeURIComponent(t)),s.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),s.isString(r)&&i.push("path="+r),s.isString(a)&&i.push("domain="+a),!0===o&&i.push("secure"),document.cookie=i.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var s=n(0);function r(){this.handlers=[]}r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){s.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,n){"use strict";var s=n(0),r=n(25),a=n(7),o=n(3),i=n(26),c=n(27);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!i(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=r(e.data,e.headers,e.transformRequest),e.headers=s.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),s.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||o.adapter)(e).then(function(t){return u(e),t.data=r(t.data,t.headers,e.transformResponse),t},function(t){return a(t)||(u(e),t&&t.response&&(t.response.data=r(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var s=n(0);e.exports=function(e,t,n){return s.forEach(n,function(n){e=n(e,t)}),e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var s=n(8);function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new s(e),t(n.reason))})}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r(function(t){e=t}),cancel:e}},e.exports=r},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");return!!(t>0||navigator.userAgent.match(/Trident.*rv\:11\./))&&parseInt(e.substring(t+5,e.indexOf(".",t)))};e.exports={post:function(e,t,n,a){var o=!1;r()&&window.XDomainRequest;var i=new XMLHttpRequest;i.open("POST",e,!0),i.withCredentials=!0,"application/x-www-form-urlencoded"===n?i.setRequestHeader("Content-type",n):"object"===(void 0===n?"undefined":s(n))?(i.setRequestHeader("Content-type",n.content_type),i.setRequestHeader("X-CSRF-TOKEN",n.csrf_token),n.access_token&&i.setRequestHeader("X-Access-Token",n.access_token),n.iflychat_token&&i.setRequestHeader("iflychat-token",n.iflychat_token),"string"!=typeof t&&"application/json"===n.content_type&&(t=JSON.stringify(t))):(i.setRequestHeader("Content-type","application/json"),"string"!=typeof t&&(t=JSON.stringify(t))),i.ontimeout=function(){o||(o=!0,a(!1))},i.timeout=5e4,i.onerror=function(){o||(o=!0,a(!1))},i.send(t),i.onreadystatechange=function(){if(4===i.readyState&&i.status>=200&&i.status<300)try{var e=JSON.parse(i.responseText);o||(o=!0,a(e))}catch(e){o||(o=!0,a("invalidTokenJSON"))}else 4===i.readyState&&(o||(o=!0,a(!1)))},i.onloadend=function(){}},get:function(e,t,n){var a=!1;r()&&window.XDomainRequest;var o=new XMLHttpRequest;o.open("GET",e),o.withCredentials=!0,"object"===(void 0===n?"undefined":s(n))&&(n.iflychat_token&&o.setRequestHeader("iflychat-token",n.iflychat_token),o.setRequestHeader("x-csrf-token",n.csrf_token)),o.ontimeout=function(){a||(a=!0,t(!1))},o.onerror=function(){a||(a=!0,t(!1))},o.timeout=2e5,o.send(),o.onreadystatechange=function(){if(4===o.readyState&&o.status>=200&&o.status<300){var e=JSON.parse(o.responseText);a=!0,t(e)}else 4===o.readyState&&(a||(a=!0,t(!1)))},o.onloadend=function(){}}}},function(e,t,n){"use strict";e.exports={SYNC_STATE:{NEW:"NEW",SAVING:"SAVING",SYNCING:"SYNCING",SYNCED:"SYNCED",LOADING:"LOADING"},RECIPIENT_STATE:{NONE:"NONE",SOME:"SOME",ALL:"ALL"},RECEIPT_STATE:{SENT:"sent",DELIVERED:"delivered",READ:"read",PENDING:"pending"},LOCALSTORAGE_KEYS:{SESSIONDATA:"iflychat-session-data-"},ACCEPT:"application/vnd.iflychat+json; version=2.0",WEBSOCKET_PROTOCOL:"iflychat-2.0",LOG:{DEBUG:4,INFO:3,WARN:2,ERROR:1,NONE:0},DELETION_MODE:{ALL:"all_participants",MY_DEVICES:"my_devices"},TYPING_STATE:{STARTED:"started",PAUSED:"paused",FINISHED:"finished"}}},function(e,t,n){"use strict";n.r(t);class s{constructor(e){this.events={}}on(e,t){(this.events[e]||(this.events[e]=[])).push(t)}off(e,t){this.events[e]&&this.events[e].splice(this.events[e].indexOf(t)>>>0,1)}emit(e,t){(this.events[e]||[]).slice().map(e=>{e(t)}),(this.events["*"]||[]).slice().map(n=>{n(e,t)})}}var r,a,o,i,c,u,l,h,d,p,g,f,_,m,I,C,y,T,w,k,A,b=n(1),v=n.n(b);class M{constructor(e){e.appId&&(this.id=e.appId),e.id&&(this.id=e.id),e.name&&(this.name=e.name)}}class S{static traverseAndConvertCamelCase(e){let t={};for(let n in e)if("object"!=typeof e[n]||Array.isArray(e[n]))if("object"==typeof e[n]&&Array.isArray(e[n])){t[S.convertCamelCaseToSnakeCase(n)]=[];for(let s in e[n])t[S.convertCamelCaseToSnakeCase(n)].push(S.traverseAndConvertCamelCase(e[n][s]))}else t[S.convertCamelCaseToSnakeCase(n)]=e[n];else t[S.convertCamelCaseToSnakeCase(n)]=S.traverseAndConvertCamelCase(e[n]);return t}static convertCamelCaseToSnakeCase(e){return e.replace(/(?:^|\.?)([A-Z])/g,function(e,t){return"_"+t.toLowerCase()}).replace(/^_/,"")}}class L{constructor(e){this.avatarUploadUrl="",this.id="",this.displayName="",this.firstName="",this.lastName="",this.email="",this.phoneNumber="",this.profileUrl="",this.avatarUrl="",this.lastSeen=0,this.isSuspended=!1,this.checkAccessToken=!1,this.data="",this.metadata={},e.id&&(this.id=e.id),e.display_name&&(this.displayName=e.display_name),e.first_name&&(this.firstName=e.first_name),e.last_name&&(this.lastName=e.last_name),e.email&&(this.email=e.email),e.phone_number&&(this.phoneNumber=e.phone_number),e.profile_url&&(this.profileUrl=e.profile_url),e.avatar_url&&(this.avatarUrl=e.avatar_url),e.avatar_upload_url&&(this.avatarUploadUrl=e.avatar_upload_url),e.last_seen?this.lastSeen=e.last_seen:this.lastSeen=0,e.is_suspended&&(this.isSuspended=e.is_suspended),e.check_access_token&&(this.checkAccessToken=e.check_access_token),e.access_token&&(this.accessToken=e.access_token),e.metadata&&(this.metadata=e.metadata),e.is_online?this.online=e.is_online:this.online=!1,e.data&&(this.data=e.data)}getId(){return this.id}getDisplayName(){return this.displayName}getData(){return this.data}getAvatarUrl(){return this.avatarUrl}getLastSeen(){return this.lastSeen}isOnline(){return this.online}getMetadata(){return this.metadata}getSerializedObject(){return JSON.parse(JSON.stringify(this))}static createFromSerializedObject(e){let t=S.traverseAndConvertCamelCase(e);return new L(t)}}class U{constructor(e){this.width=e.width,this.height=e.height,this.originalWidth=e.original_width,this.originalHeight=e.original_height,this.url=e.url,this.checkSessionKey=e.check_session_key}getUrl(){let e="";return this.checkSessionKey&&(e="?session_key="+he.getInstance().sessionKey),this.url+e}getWidth(){return this.width}getHeight(){return this.height}getOriginalWidth(){return this.originalWidth}getOriginalHeight(){return this.originalHeight}}class E{constructor(e){if(this.thumbnails=[],this.url=e.url,this.name=e.name,this.type=e.type,this.checkSessionKey=e.check_session_key,e.thumbnails)for(let t in e.thumbnails)this.thumbnails[t]=new U(e.thumbnails[t])}getType(){return this.type}getName(){return this.name}getUrl(){let e="";return this.checkSessionKey&&(e="?session_key="+he.getInstance().sessionKey),this.url+e}getThumbnails(){return this.thumbnails}}class P{constructor(e){this.id=e.id,this.type=e.type,"attachment"===e.type?this.attachment=new E(e.attachment):this.text=e.text,e.custom_filter?this.customFilter=e.custom_filter:this.customFilter=[],e.metadata?this.metadata=e.metadata:this.metadata={},"announcement"!==e.type&&(this.user=new L(e.user)),this.insertedAt=e.inserted_at,this.updatedAt=0,e.updated_at&&(this.updatedAt=e.updated_at)}getId(){return this.id}getText(){return this.text}getType(){return this.type}getInsertedAt(){return this.insertedAt}getUser(){return this.user}getAttachment(){return this.attachment}getSerializedObject(){return JSON.parse(JSON.stringify(this))}static createFromSerializedObject(e){let t=S.traverseAndConvertCamelCase(e);return new P(t)}}class N{constructor(e,t){this.width=e,this.height=t}}class F{constructor(){}setCustomFilter(e){this.customFilter=e}setData(e){this.data=e}setMetadata(e){this.metadata=e}setText(e){this.text=e}setThumbnailDimensions(e){this.thumbnailDimensions=e}setAttachment(e){this.attachment=e}getCustomFilter(){return this.customFilter}getData(){return this.data}getMetadata(){return this.metadata}getText(){return this.text}getThumbnailDimensions(){return this.thumbnailDimensions}getAttachment(){return this.attachment}}class O{constructor(e){this.code=e.code,this.message=e.message}getMessage(){return this.message}getCode(){return this.code}}!function(e){e.PARTICIPANT_STATE_ALL="ALL",e.PARTICIPANT_STATE_INVITED="INVITED",e.PARTICIPANT_STATE_ACCEPTED="ACCEPTED",e.RECENT_CHAT="RECENT_CHAT",e.CHRONOLOGICAL="CHRONOLOGICAL",e.ALPHABETICAL="ALPHABETICAL",e.QUERY_TYPE_AND="AND",e.QUERY_TYPE_OR="OR"}(r||(r={})),function(e){e.AND="AND",e.OR="OR"}(a||(a={})),function(e){e.ALL="ALL",e.VIEW_ONLY="VIEW_ONLY",e.WRITE_AND_VIEW="WRITE_AND_VIEW"}(o||(o={})),function(e){e.ALL="ALL",e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE"}(i||(i={})),function(e){e.ALL="All",e.TRUE="TRUE",e.FALSE="FALSE"}(c||(c={})),function(e){e.RECENT_CHAT="RECENT_CHAT",e.CHRONOLOGICAL="CHRONOLOGICAL",e.ALPHABETICAL="ALPHABETICAL"}(u||(u={})),function(e){e.PARTICIPANT_STATE_ALL="ALL",e.PARTICIPANT_STATE_INVITED="INVITED",e.PARTICIPANT_STATE_ACCEPTED="ACCEPTED"}(l||(l={})),function(e){e.ALL="All",e.PUBLIC="PUBLIC",e.PRIVATE="PRIVATE"}(h||(h={}));class D{constructor(){this.participantStateFilter=l.PARTICIPANT_STATE_ALL,this.limit=20,this.order=u.RECENT_CHAT,this.includeEmpty=!0}setActiveFilter(e){this.activeFilter=e}setChannelIdsFilter(e){this.channelIdsFilter=e}setChannelNameSearch(e){this.channelNameSearch=e}setCustomFilter(e){this.customFilter=e}setCustomFilterQueryType(e){this.customFilterQueryType=e}setCustomFilterSearch(e){this.customFilterSearch=e}setIncludeEmpty(e){this.includeEmpty=e}setIsDistinctFilter(e){this.isDistinctFilter=e}setLimit(e){this.limit=e}setOrder(e){this.order=e}setReference(e){this.reference=e}setParticipantState(e){this.participantStateFilter=e}setPublicFilter(e){this.publicFilter=e}setUserIdsAllFilter(e){this.userIdsAllFilter=e}setUserIdsFilterSearch(e){this.userIdsFilterSearch=e}setUserNameSearch(e){this.userNameSearch=e}setViewOnlyFilter(e){this.viewOnlyFilter=e}setUserIdsFilterSearchQueryType(e){this.userIdsFilterSearchQueryType=e}load(e){let t={participant_state_filter:this.participantStateFilter,limit:this.limit,order:this.order};this.activeFilter&&(t.active_filter=this.activeFilter),this.channelIdsFilter&&(t.channel_ids_filter=this.channelIdsFilter),this.channelNameSearch&&(t.channel_name_search=this.channelNameSearch),this.customFilter&&(t.custom_filter=this.customFilter),this.customFilterQueryType&&(t.custom_filter_query_type=this.customFilterQueryType),this.customFilterSearch&&(t.custom_filter_search=this.customFilterSearch),this.includeEmpty?t.include_empty=this.includeEmpty:t.include_empty=!1,this.isDistinctFilter&&(t.is_distinct_filter=this.isDistinctFilter),this.publicFilter&&(t.public_filter=this.publicFilter),this.reference&&(t.reference=this.reference),this.userIdsAllFilter&&(t.user_ids_all_filter=this.userIdsAllFilter),this.userIdsFilterSearch&&(t.user_ids_filter_search=this.userIdsFilterSearch),this.userIdsFilterSearchQueryType&&(t.user_ids_filter_search_query_type=this.userIdsFilterSearchQueryType),this.userNameSearch&&(t.user_name_search=this.userNameSearch),this.viewOnlyFilter&&(t.view_only_filter=this.viewOnlyFilter),t.get_participants=!0,t.get_read_receipt=!0;let n=he.getInstance().transportManager.send({t:"group_channels.my_list",d:t}),s=t=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),e(null,t)),r=t=>{let a=new O(t);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),e(a,null)};return he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r),!0}}!function(e){e.AND="AND",e.OR="OR"}(d||(d={})),function(e){e.ALL="ALL",e.VIEW_ONLY="VIEW_ONLY",e.WRITE_AND_VIEW="WRITE_AND_VIEW"}(p||(p={})),function(e){e.ALL="ALL",e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE"}(g||(g={})),function(e){e.ALL="All",e.TRUE="TRUE",e.FALSE="FALSE"}(f||(f={})),function(e){e.RECENT_CHAT="RECENT_CHAT",e.CHRONOLOGICAL="CHRONOLOGICAL",e.ALPHABETICAL="ALPHABETICAL"}(_||(_={}));class R{constructor(){this.limit=20,this.order=_.RECENT_CHAT,this.includeEmpty=!0}setActiveFilter(e){this.activeFilter=e}setChannelIdsFilter(e){this.channelIdsFilter=e}setChannelNameSearch(e){this.channelNameSearch=e}setCustomFilter(e){this.customFilter=e}setCustomFilterQueryType(e){this.customFilterQueryType=e}setCustomFilterSearch(e){this.customFilterSearch=e}setIncludeEmpty(e){this.includeEmpty=e}setIsDistinctFilter(e){this.isDistinctFilter=e}setLimit(e){this.limit=e}setOrder(e){this.order=e}setReference(e){this.reference=e}setUserIdsAllFilter(e){this.userIdsAllFilter=e}setUserIdsFilterSearch(e){this.userIdsFilterSearch=e}setUserNameSearch(e){this.userNameSearch=e}setViewOnlyFilter(e){this.viewOnlyFilter=e}setUserIdsFilterSearchQueryType(e){this.userIdsFilterSearchQueryType=e}load(e){let t={limit:this.limit,order:this.order};this.activeFilter&&(t.active_filter=this.activeFilter),this.channelIdsFilter&&(t.channel_ids_filter=this.channelIdsFilter),this.channelNameSearch&&(t.channel_name_search=this.channelNameSearch),this.customFilter&&(t.custom_filter=this.customFilter),this.customFilterQueryType&&(t.custom_filter_query_type=this.customFilterQueryType),this.customFilterSearch&&(t.custom_filter_search=this.customFilterSearch),this.includeEmpty?t.include_empty=this.includeEmpty:t.include_empty=!1,this.isDistinctFilter&&(t.is_distinct_filter=this.isDistinctFilter),this.reference&&(t.reference=this.reference),this.userIdsAllFilter&&(t.user_ids_all_filter=this.userIdsAllFilter),this.userIdsFilterSearch&&(t.user_ids_filter_search=this.userIdsFilterSearch),this.userIdsFilterSearchQueryType&&(t.user_ids_filter_search_query_type=this.userIdsFilterSearchQueryType),this.userNameSearch&&(t.user_name_search=this.userNameSearch),this.viewOnlyFilter&&(t.view_only_filter=this.viewOnlyFilter);let n=he.getInstance().transportManager.send({t:"group_channels.list",d:t}),s=t=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),e(null,t)),r=t=>{let a=new O(t);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),e(a,null)};return he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r),!0}}!function(e){e.SORT_BY_INSERTED_AT="INSERTED_AT",e.SORT_BY_UPDATED_AT="UPDATED_AT"}(m||(m={})),function(e){e.AND="AND",e.OR="OR"}(I||(I={})),function(e){e.PREVIOUS="previous",e.NEXT="next"}(C||(C={}));class B{constructor(e){this.limit=20,this.channel=e,this.sortBy=m.SORT_BY_INSERTED_AT}setCustomFilter(e){this.customFilter=e}setCustomFilterQueryType(e){this.customFilterQueryType=e}setDirection(e){this.direction=e}setLimit(e){this.limit=e}setMessageTypeFilter(e){this.messageTypeFilter=e}setMessageTypeFilterQueryType(e){this.messageTypeFilterQueryType=e}setReference(e){this.reference=e}setSortBy(e){this.sortBy=e}setTextSearch(e){this.textSearch=e}setTimestamp(e){this.timestamp=e}setUserId(e){this.userId=e}load(e){let t,n;n={id:this.channel.getId(),limit:this.limit,sort_by:this.sortBy},this.reference&&(n.reference=this.reference),this.customFilter&&(n.custom_filter=this.customFilter),this.customFilterQueryType&&(n.custom_filter_query_type=this.customFilterQueryType),this.direction&&(n.direction=this.direction),this.messageTypeFilter&&(n.message_type_filter=this.messageTypeFilter),this.messageTypeFilterQueryType&&(n.message_type_filter_query_type=this.messageTypeFilterQueryType),this.textSearch&&(n.text_search=this.textSearch),this.timestamp&&(n.timestamp=this.timestamp),this.userId&&(n.user_id=this.userId),t=he.getInstance().transportManager.send({t:this.channel.getType()+"_channels.history",d:n});let s=n=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",s),he.getInstance().off("to."+t+".error",r)},0),e(null,n)),r=n=>{let a=new O(n);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",s),he.getInstance().off("to."+t+".error",r)},0),e(a,null)};return he.getInstance().on("to."+t+".success",s),he.getInstance().on("to."+t+".error",r),!0}count(e){let t;t=he.getInstance().transportManager.send({t:this.channel.getType()+"_channels.messages_count",d:{id:this.channel.getId(),limit:this.limit,reference:this.reference,sort_by:this.sortBy}});let n=r=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(null,r)),s=r=>{let a=new O(r);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(a,null)};return he.getInstance().on("to."+t+".success",n),he.getInstance().on("to."+t+".error",s),!0}}class x extends L{constructor(e){super(e),this.blockedByMe=!1,this.blockingMe=!1,this.moderator=!1,e.status&&(this.status=e.status),e.is_blocked_by_me&&(this.blockedByMe=e.is_blocked_by_me),e.is_blocking_me&&(this.blockingMe=e.is_blocking_me),e.is_moderator&&(this.moderator=e.is_moderator)}isModerator(){return this.moderator}isBlockingMe(){return this.blockingMe}isBlockedByMe(){return this.blockedByMe}getInvitationState(){}getSerializedObject(){return JSON.parse(JSON.stringify(this))}static createFromSerializedObject(e){let t=S.traverseAndConvertCamelCase(e);return new x(t)}}!function(e){e.BANNED="BANNED",e.ALL="ALL",e.MUTED="MUTED",e.MODERATOR="MODERATOR"}(y||(y={}));class G{constructor(e,t){this.limit=20,this.channel=t,this.type=e}setLimit(e){this.limit=e}setReference(e){this.reference=e}load(e){let t,n;this.type===y.ALL?n=this.channel.getType()+"_channels.participants_list":this.type===y.BANNED?n=this.channel.getType()+"_channels.ban_list":this.type===y.MUTED?n=this.channel.getType()+"_channels.mute_list":this.type===y.MODERATOR&&(n=this.channel.getType()+"_channels.moderators_list"),t=he.getInstance().transportManager.send({t:n,d:{id:this.channel.id,limit:this.limit,reference:this.reference}});let s=n=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",s),he.getInstance().off("to."+t+".error",r)},0),n.length>0&&(this.reference=n[n.length-1].id),e(null,n)),r=n=>{let a=new O(n);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",s),he.getInstance().off("to."+t+".error",r)},0),e(a,null)};return he.getInstance().on("to."+t+".success",s),he.getInstance().on("to."+t+".error",r),!0}}class H{constructor(){this.customFilter=[],this.customFilterQueryType="OR"}setCustomFilter(e){this.customFilter=e}setCustomFilterQueryType(e){this.customFilterQueryType=e}getCustomFilter(){return this.customFilter}getCustomFilterQueryType(){return this.customFilterQueryType}}!function(e){e.OPEN="open",e.GROUP="group"}(T||(T={}));class j{constructor(e){this.customFilter=[],e.id&&(this.id=e.id),e.name&&(this.name=e.name),e.data&&(this.data=e.data),e.avatar_url&&(this.avatarUrl=e.avatar_url),e.metadata&&(this.metadata=e.metadata),e.updated_at&&(this.updatedAt=e.updated_at),e.inserted_at&&(this.insertedAt=e.inserted_at),e.custom_filter&&(this.customFilter=e.custom_filter),e.is_view_only?this.viewOnly=e.is_view_only:this.viewOnly=!1,e.is_active?this.active=e.is_active:this.active=!1,e.participants_count?this.participantsCount=e.participants_count:this.participantsCount=0,e.is_muted_for_me?this.mutedForMe=e.is_muted_for_me:this.mutedForMe=!1,e.is_moderator?this.moderator=e.is_moderator:this.moderator=!1}getAvatarUrl(){return this.avatarUrl}getType(){return this.isGroupChannel()?T.GROUP:T.OPEN}getCustomFilter(){return this.customFilter}isGroupChannel(){return this instanceof q}isOpenChannel(){return!this.isGroupChannel()}getId(){return this.id}getName(){return this.name}getParticipantsCount(){return this.participantsCount}getMetadata(){return this.metadata}isModerator(e){return this.moderator}isMuted(){return this.mutedForMe}sendMessage(e,t,n,s){let r=new F;return s?(r.setText(e),r.setMetadata(t),r.setCustomFilter(n),this._sendMessage(r,s)):n?(r.setText(e),r.setMetadata(t),this._sendMessage(r,n)):!!t&&(e instanceof F?this._sendMessage(e,t):(r.setText(e),this._sendMessage(r,t)))}_sendMessage(e,t){let n={id:this.id,type:"text"};n.text=e instanceof F?e.text:e,e.metadata&&(n.metadata=e.metadata),e.customFilter&&(n.custom_filter=e.customFilter),e.data&&(n.data=e.data);let s=he.getInstance().transportManager.send({t:this.getType()+"_channels.message",d:n}),r=e=>(window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(null,e)),a=e=>{let n=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(n,null)};return he.getInstance().on("to."+s+".success",r),he.getInstance().on("to."+s+".error",a),!0}sendAttachment(e,t,n){let s,r=[],a={id:this.id,type:"attachment"};e instanceof File?s=e:e instanceof F&&(s=e.getAttachment(),r=e.getThumbnailDimensions(),a.metadata&&(a.metadata=a.metadata),a.customFilter&&(a.custom_filter=a.customFilter),a.data&&(a.data=a.data)),he.getInstance()._uploadAttachment({file:s,channelType:this.getType()+"_channel",channelId:this.id,thumbnails:r},t,(e,t)=>{if(e)return n(e,null);a.attachment=t;let s=he.getInstance().transportManager.send({t:this.getType()+"_channels.message",d:a}),r=e=>(window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",o)},0),n(null,e)),o=e=>{let t=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",o)},0),n(t,null)};return he.getInstance().on("to."+s+".success",r),he.getInstance().on("to."+s+".error",o),!0})}updateMetadata(e,t){let n=he.getInstance().transportManager.send({t:this.getType()+"_channels.update",d:{id:this.id,metadata:e}}),s=e=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(null,e)),r=e=>{let a=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(a,null)};he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r)}addModerator(e,t){return this._addModerators([e],t)}addModerators(e,t){return this._addModerators(e,t)}_addModerators(e,t){let n=he.getInstance().transportManager.send({t:this.getType()+"_channels.moderators_add",d:{id:this.id,moderator_ids:e}}),s=()=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(e)};return he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r),!0}removeModerator(e,t){return this._removeModerators([e],t)}removeModerators(e,t){return this._removeModerators(e,t)}_removeModerators(e,t){let n=he.getInstance().transportManager.send({t:this.getType()+"_channels.moderators_remove",d:{id:this.id,moderator_ids:e}}),s=()=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(e)};return he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r),!0}banParticipant(e,t,n,s){let r=t,a={id:this.id,participant_id:e};"function"==typeof s?(r=s,a.duration=t,a.data=n):"function"==typeof n&&(r=n,a.duration=t);let o=he.getInstance().transportManager.send({t:this.getType()+"_channels.ban",d:a}),i=()=>(window.setTimeout(()=>{he.getInstance().off("to."+o+".success",i),he.getInstance().off("to."+o+".error",c)},0),r(null)),c=e=>{new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+o+".success",i),he.getInstance().off("to."+o+".error",c)},0),r(e)};return he.getInstance().on("to."+o+".success",i),he.getInstance().on("to."+o+".error",c),!0}unbanParticipant(e,t){let n=he.getInstance().transportManager.send({t:this.getType()+"_channels.unban",d:{id:this.id,participant_id:e}}),s=()=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(e)};return he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r),!0}muteParticipant(e,t,n,s){let r=t,a={id:this.id,participant_id:e};"function"==typeof s?(r=s,a.duration=t,a.data=n):"function"==typeof n&&(r=n,a.duration=t);let o=he.getInstance().transportManager.send({t:this.getType()+"_channels.mute",d:a}),i=e=>(window.setTimeout(()=>{he.getInstance().off("to."+o+".success",i),he.getInstance().off("to."+o+".error",c)},0),r(null,e)),c=e=>{new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+o+".success",i),he.getInstance().off("to."+o+".error",c)},0),r(e,null)};return he.getInstance().on("to."+o+".success",i),he.getInstance().on("to."+o+".error",c),!0}unmuteParticipant(e,t){let n=he.getInstance().transportManager.send({t:this.getType()+"_channels.unmute",d:{id:this.id,participant_id:e}}),s=e=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(null,e)),r=e=>{new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(e,null)};return he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r),!0}createBannedParticipantListQuery(){return new G(y.BANNED,this)}createMutedParticipantListQuery(){return new G(y.MUTED,this)}createModeratorListQuery(){return new G(y.MODERATOR,this)}createParticipantListQuery(){return new G(y.ALL,this)}getMessage(e,t){let n={id:this.id,message_id:e},s=he.getInstance().transportManager.send({t:this.getType()+"_channels.message_get",d:n}),r=e=>(window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(null,e)),a=e=>{let n=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(n,null)};he.getInstance().on("to."+s+".success",r),he.getInstance().on("to."+s+".error",a)}updateMessage(e,t,n){let s={id:this.id,message_id:e};t.getCustomFilter()&&(s.custom_filter=t.getCustomFilter()),t.getData()&&(s.data=t.getData()),t.getMetadata()&&(s.metadata=t.getMetadata()),t.getText()&&(s.text=t.getText());let r=he.getInstance().transportManager.send({t:this.getType()+"_channels.message_update",d:s}),a=e=>(window.setTimeout(()=>{he.getInstance().off("to."+r+".success",a),he.getInstance().off("to."+r+".error",o)},0),n(null,e)),o=e=>{let t=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+r+".success",a),he.getInstance().off("to."+r+".error",o)},0),n(t,null)};he.getInstance().on("to."+r+".success",a),he.getInstance().on("to."+r+".error",o)}deleteMessage(e,t){let n={id:this.id,message_id:e},s=he.getInstance().transportManager.send({t:this.getType()+"_channels.message_delete",d:n}),r=e=>(window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(null)),a=e=>{let n=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(n)};he.getInstance().on("to."+s+".success",r),he.getInstance().on("to."+s+".error",a)}setViewOnly(e,t){let n=he.getInstance().transportManager.send({t:this.getType()+"_channels.view_only",d:{id:this.id,is_view_only:e}}),s=()=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(e)};return he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r),!0}setActive(e,t){let n=he.getInstance().transportManager.send({t:this.getType()+"_channels.active",d:{id:this.id,is_active:e}}),s=()=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(e)};return he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r),!0}clearHistory(e){let t=he.getInstance().transportManager.send({t:this.getType()+"_channels.clear_history",d:{id:this.id}}),n=()=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new O(r);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(r)};return he.getInstance().on("to."+t+".success",n),he.getInstance().on("to."+t+".error",s),!0}delete(e){let t=he.getInstance().transportManager.send({t:this.getType()+"_channels.delete",d:{id:this.id}}),n=()=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new O(r);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(r)};return he.getInstance().on("to."+t+".success",n),he.getInstance().on("to."+t+".error",s),!0}join(e){let t=he.getInstance().transportManager.send({t:this.getType()+"_channels.join",d:{id:this.id}}),n=r=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new O(r);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(r)};return he.getInstance().on("to."+t+".success",n),he.getInstance().on("to."+t+".error",s),!0}leave(e){let t=he.getInstance().transportManager.send({t:this.getType()+"_channels.leave",d:{id:this.id}}),n=r=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new O(r);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(r)};return he.getInstance().on("to."+t+".success",n),he.getInstance().on("to."+t+".error",s),!0}getTotalMessageCount(e,t){"object"==typeof t?this._getTotalMessageCount(e,t):this._getTotalMessageCount(new H,e)}_getTotalMessageCount(e,t){let n={id:this.id},s=he.getInstance().transportManager.send({t:this.getType()+"_channels.messages_count",d:n}),r=e=>(window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(null,e)),a=e=>{new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(e,null)};return he.getInstance().on("to."+s+".success",r),he.getInstance().on("to."+s+".error",a),!0}getData(){return this.data}isViewOnly(){return this.viewOnly}isActive(){return this.active}}class V{constructor(){}setName(e){this.name=e}getName(){return this.name}setAvatarUrl(e){this.avatarUrl=e}getAvatarUrl(){return this.avatarUrl}setAvatarFile(e){this.avatarFile=e}getAvatarFile(){return this.avatarFile}setModeratorIds(e){this.moderatorIds=e}getModeratorIds(){return this.moderatorIds}setCustomFilter(e){this.customFilter=e}setData(e){this.data=e}setMetadata(e){this.metadata=e}getCustomFilter(){return this.customFilter}getData(){return this.data}getMetadata(){return this.metadata}}class Q extends V{constructor(){super(),this.isDistinct=!1}setParticipantIds(e){this.participantIds=e}getParticipantIds(){return this.participantIds}setPublic(e){this.isPublic=e}getPublic(){return this.isPublic}setDistinct(e){this.isDistinct=e}getDistinct(){return this.isDistinct}}class q extends j{constructor(e){if(super(e),this.unreadMessageCount=0,e.participants){this.participants=[];for(let t in e.participants)this.participants.push(new x(e.participants[t]))}e.unread_message_count?this.unreadMessageCount=e.unread_message_count:this.unreadMessageCount=0,e.last_message&&(this.lastMessage=new P(e.last_message)),e.is_distinct?this.isDistinct=e.is_distinct:this.isDistinct=!1,e.read_receipt&&(this.readReceipt=e.read_receipt),e.is_archived?this.archived=e.is_archived:this.archived=!1,e.my_status&&(this.myStatus=e.my_status),this.cachedParticipantsTypingStatus={},this.lastStartTyping=0,this.lastStopTyping=0,e.cached_participants_typing_status&&(this.cachedParticipantsTypingStatus=e.cached_participants_typing_status),e.last_start_typing&&(this.lastStartTyping=e.last_start_typing),e.last_stop_typing&&(this.lastStopTyping=e.last_stop_typing)}static create(){if(2==arguments.length)this._create(arguments[0],arguments[1]);else if(4==arguments.length){if("string"==typeof arguments[0]&&"object"==typeof arguments[1]&&(arguments[2],1)&&(arguments[3],1)){let e=new Q;e.setName(arguments[0]),e.setParticipantIds(arguments[1]),e.setDistinct(arguments[2]),this._create(e,arguments[3])}}else if(5===arguments.length&&"string"==typeof arguments[0]&&"object"==typeof arguments[1]&&(arguments[2],1)&&"object"==typeof arguments[1]&&(arguments[4],1)){let e=new Q;e.setName(arguments[0]),e.setParticipantIds(arguments[1]),e.setDistinct(arguments[2]),e.setCustomFilter(arguments[3]),this._create(e,arguments[4])}}static _create(e,t){let n={};e.getName()&&(n.name=e.getName()),e.getParticipantIds()&&(n.participant_ids=e.getParticipantIds()),e.getCustomFilter()&&(n.custom_filter=e.getCustomFilter()),e.getData()&&(n.data=e.getData()),e.getMetadata()&&(n.metadata=e.getMetadata()),e.getAvatarUrl()&&(n.avatar_url=e.getAvatarUrl()),e.getModeratorIds()&&(n.moderator_ids=e.getModeratorIds()),e.getPublic()&&(n.is_public=e.getPublic()),e.getAvatarFile()&&(n.avatar_file=e.getAvatarFile()),n.is_distinct=e.getDistinct();let s=he.getInstance().transportManager.send({t:"group_channels.create",d:n}),r=e=>(window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(null,e)),a=e=>{let n=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(n,null)};he.getInstance().on("to."+s+".success",r),he.getInstance().on("to."+s+".error",a)}static _upsert(e){let t=new q(e);q.cachedChannels[t.getId()]=t}static get(e,t){return q.cachedChannels&&q.cachedChannels[e]?t(null,q.cachedChannels[e]):this._getFromServer(e,t)}static _getFromServer(e,t){let n=he.getInstance().transportManager.send({t:"group_channels.get",d:{id:e,get_participants:!0,get_read_receipt:!0}}),s=e=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(null,e)),r=e=>{let a=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(a,null)};he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r)}update(e,t){let n={id:this.id};e.getName()&&(n.name=e.getName()),e.getParticipantIds()&&(n.participant_ids=e.getParticipantIds()),e.getCustomFilter()&&(n.custom_filter=e.getCustomFilter()),e.getData()&&(n.data=e.getData()),e.getMetadata()&&(n.metadata=e.getMetadata()),e.getAvatarUrl()&&(n.avatar_url=e.getAvatarUrl()),e.getModeratorIds()&&(n.moderator_ids=e.getModeratorIds()),e.getPublic()&&(n.is_public=e.getPublic()),e.getAvatarFile()&&(n.avatar_file=e.getAvatarFile()),n.is_distinct=e.getDistinct();let s=he.getInstance().transportManager.send({t:"group_channels.update",d:n}),r=e=>(window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(null,e)),a=e=>{let n=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(n,null)};he.getInstance().on("to."+s+".success",r),he.getInstance().on("to."+s+".error",a)}_uploadAvatar(e,t,n){let s=new FormData;s.append("app_id",he.getInstance().app.id),s.append("user_id",he.getInstance().user.id),he.getInstance().user.accessToken&&s.append("user_access_token",he.getInstance().user.accessToken),s.append("id",this.id),s.append("avatar_file",e);let r={headers:{"content-type":"multipart/form-data"},onUploadProgress:e=>{t(e.loaded,e.total)}};v.a.post(he.getInstance().baseUrl+"/group_channels.avatar_upload",s,r).then(e=>e.data&&e.data.group_channel?n(null,e.data.group_channel.avatar_url):n(e.data.error,null)).catch(e=>n(e,null))}updatePushNotificationPreference(e,t,n,s,r,a,o){he.getInstance()._updatePushNotificationPreference({doNotDisturb:e,startHour:t,startMin:n,endHour:s,endMin:r,timezone:a,groupChannelId:this.id},o)}getPushNotificationPreference(e){he.getInstance()._getPushNotificationPreference({groupChannelId:this.id},e)}sync(e){let t=he.getInstance().transportManager.send({t:"group_channels.get",d:{id:this.id}}),n=r=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(null,r)),s=r=>{let a=new O(r);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(a,null)};return he.getInstance().on("to."+t+".success",n),he.getInstance().on("to."+t+".error",s),!0}inviteParticipants(e,t){let n=he.getInstance().transportManager.send({t:"group_channels.invite",d:{id:this.id,participant_ids:e}}),s=e=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(e)};return he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r),!0}inviteParticipant(e,t){return this.inviteParticipants([e],t)}acceptInvitation(e){let t=he.getInstance().transportManager.send({t:"group_channels.accept",d:{id:this.id}}),n=r=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new O(r);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(r)};return he.getInstance().on("to."+t+".success",n),he.getInstance().on("to."+t+".error",s),!0}declineInvitation(e){let t=he.getInstance().transportManager.send({t:"group_channels.decline",d:{id:this.id}}),n=r=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new O(r);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(r)};return he.getInstance().on("to."+t+".success",n),he.getInstance().on("to."+t+".error",s),!0}isTyping(){return Object.keys(this.cachedParticipantsTypingStatus).length>0}setTypingStatus(e,t){t?this.cachedParticipantsTypingStatus[e]=(new Date).getTime():delete this.cachedParticipantsTypingStatus[e]}checkTypingStatus(){let e=!1;for(let t in this.cachedParticipantsTypingStatus)this.cachedParticipantsTypingStatus[t]<(new Date).getTime()-1e4&&(delete this.cachedParticipantsTypingStatus[t],e=!0);return e}startTyping(){if(this.lastStartTyping<(new Date).getTime()-1e4){he.getInstance().transportManager.send({t:"group_channels.start_typing",d:{id:this.id}});return this.lastStartTyping=(new Date).getTime(),!0}}stopTyping(){if(this.lastStopTyping<(new Date).getTime()-1e4){he.getInstance().transportManager.send({t:"group_channels.stop_typing",d:{id:this.id}});return this.lastStopTyping=(new Date).getTime(),!0}}markAsRead(){return this.getCurrentUserReadStatus()||this._markAsRead(),!0}_markAsRead(){he.getInstance().transportManager.send({t:"group_channels.read",d:{id:this.id}});return!0}getReadReceipt(e){return this.readReceipt}getReadParticipants(e){let t=[];for(let n in this.participants){let s=e.insertedAt;this.readReceipt[this.participants[n].id]>=s&&t.push(this.participants[n])}return t}getUnreadParticipants(e){let t=[];for(let n in this.participants){let s=e.insertedAt;this.readReceipt[this.participants[n].id]<s&&t.push(this.participants[n])}return t}getUnreadParticipantsCount(e){return this.getUnreadParticipants(e).length}getUnreadMessageCount(){return this.unreadMessageCount}getCurrentUserReadStatus(){if(this.lastMessage){let e=this.lastMessage.insertedAt;return this.readReceipt[he.getInstance().user.id]>=e}return!0}getLastMessage(){return this.lastMessage}getParticipants(){return this.participants}getTypingParticipants(){let e=[];for(let t in this.cachedParticipantsTypingStatus)for(let n in this.participants)if(t===this.participants[n].id){e.push(this.participants[n]);break}return e}getId(){return this.id}getName(){return this.name}static createGroupChannelListQuery(){return new D}static createPublicGroupChannelListQuery(){return new R}createPreviousMessageListQuery(){return new B(this)}static purgeCache(){q.cachedChannels={}}static getTotalGroupChannelCount(e,t){"object"==typeof t?q._getTotalGroupChannelCount(e,t):q._getTotalGroupChannelCount(new H,e)}static _getTotalGroupChannelCount(e,t){let n={custom_filter_query_type:e.getCustomFilterQueryType()};e.getCustomFilter().length&&(n.custom_filter=e.getCustomFilter());let s=he.getInstance().transportManager.send({t:"group_channels.my_list_count",d:n}),r=n=>{let o=e.getCustomFilter().join("")+e.getCustomFilterQueryType();return q.cachedTotalGroupChannelCount[o]={count:n,params:e},window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(null,n,e)},a=e=>{new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(e,null,null)};return he.getInstance().on("to."+s+".success",r),he.getInstance().on("to."+s+".error",a),!0}archive(e){let t=he.getInstance().transportManager.send({t:"group_channels.archive",d:{id:this.id,is_archive:!0}}),n=r=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new O(r);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(r)};return he.getInstance().on("to."+t+".success",n),he.getInstance().on("to."+t+".error",s),!0}unarchive(e){let t=he.getInstance().transportManager.send({t:"group_channels.archive",d:{id:this.id,is_archive:!1}}),n=r=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new O(r);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(r)};return he.getInstance().on("to."+t+".success",n),he.getInstance().on("to."+t+".error",s),!0}isArchived(){return this.archived}getMyStatus(){return this.myStatus}isModerator(e){if(!e)return this.moderator;if(this.participants)for(let t in this.participants)if(this.participants[t].id===e&&this.participants[t].isModerator)return!0;return!1}beta(){return{getDirectChannelName:()=>2===this.getParticipantsCount()?this.getParticipants()[0].getId()===he.getInstance().getCurrentUser().getId()?this.getParticipants()[1].getDisplayName():this.getParticipants()[0].getDisplayName():this.getName(),getDirectChannelAvatarUrl:()=>2===this.getParticipantsCount()?this.getParticipants()[0].getId()===he.getInstance().getCurrentUser().getId()?this.getParticipants()[1].getAvatarUrl():this.getParticipants()[0].getAvatarUrl():this.getAvatarUrl(),getDirectChannelStatus:()=>2===this.getParticipantsCount()&&(this.getParticipants()[0].getId()===he.getInstance().getCurrentUser().getId()?this.getParticipants()[1].isOnline():this.getParticipants()[0].isOnline()),getDirectChannelId:()=>2===this.getParticipantsCount()?this.getParticipants()[0].getId()===he.getInstance().getCurrentUser().getId()?this.getParticipants()[1].getId():this.getParticipants()[0].getId():this.getId(),getDirectChannelIsBlockedByMe:()=>2===this.getParticipantsCount()&&(this.getParticipants()[0].getId()===he.getInstance().getCurrentUser().getId()?this.getParticipants()[1].isBlockedByMe():this.getParticipants()[0].isBlockedByMe())}}getSerializedObject(){return JSON.parse(JSON.stringify(this))}static createFromSerializedObject(e){let t=S.traverseAndConvertCamelCase(e);return new q(t)}}q.cachedChannels={},q.cachedTotalGroupChannelCount={};class W{constructor(){this.onMessageDeleted=function(e,t){},this.onMessageReceived=function(e,t){},this.onMessageUpdated=function(e,t){},this.onTypingStatusChanged=function(e){},this.onReadStatusUpdated=function(e){},this.onChannelDeleted=function(e){},this.onChannelUpdated=function(e){},this.onParticipantJoined=function(e,t){},this.onParticipantLeft=function(e,t){},this.onParticipantInvited=function(e,t){},this.onParticipantDeclined=function(e,t){},this.onParticipantBanned=function(e,t){},this.onParticipantUnbanned=function(e,t){},this.onParticipantMuted=function(e,t){},this.onParticipantUnmuted=function(e,t){},this.onArchived=function(e){},this.onUnarchived=function(e){},this.onHistoryCleared=function(e){},this.onTotalChannelCount=((e,t)=>{})}}class z{constructor(){this.onConnectionChanged=function(e){}}}class J{constructor(){this.onTotalUnreadMessageCount=((e,t)=>{}),this.onTotalUnreadGroupChannelCount=((e,t)=>{})}}!function(e){e.ALL="ALL",e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE"}(w||(w={})),function(e){e.AND="AND",e.OR="OR"}(k||(k={})),function(e){e.ALL="ALL",e.VIEW_ONLY="VIEW_ONLY",e.WRITE_AND_VIEW="WRITE_AND_VIEW"}(A||(A={}));var K,Y,X=class{constructor(){this.limit=20}setActiveFilter(e){this.activeFilter=e}setChannelIdsFilter(e){this.channelIdsFilter=e}setChannelNameSearch(e){this.channelNameSearch=e}setCustomFilter(e){this.customFilter=e}setCustomFilterQueryType(e){this.customFilterQueryType=e}setCustomFilterSearch(e){this.customFilterSearch=e}setLimit(e){this.limit=e}setReference(e){this.reference=e}setViewOnlyFilter(e){this.viewOnlyFilter=e}load(e){let t=he.getInstance().transportManager.send({t:"open_channels.list",d:{reference:this.reference,limit:this.limit}}),n=r=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(null,r)),s=r=>{let a=new O(r);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",n),he.getInstance().off("to."+t+".error",s)},0),e(a,null)};return he.getInstance().on("to."+t+".success",n),he.getInstance().on("to."+t+".error",s),!0}};!function(e){e.IS_ACTIVE_FILTER_ACTIVE="ACTIVE",e.IS_ACTIVE_FILTER_DEACTIVE="DEACTIVE",e.IS_ACTIVE_FILTER_ALL="ALL",e.IS_ONLINE_FILTER_ONLINE="ONLINE",e.IS_ONLINE_FILTER_OFFLINE="OFFLINE",e.IS_ONLINE_FILTER_ALL="ALL",e.ORDER_CHRONOLOGICAL="CHRONOLOGICAL",e.ORDER_ALPHABETICAL="ALPHABETICAL"}(K||(K={})),function(e){e.BLOCKED_USER="BLOCKED_USER",e.ALL_USER="ALL_USER"}(Y||(Y={}));class ${constructor(e){this.type=e,this.limit=20,this.isActiveFilter=K.IS_ACTIVE_FILTER_ACTIVE,this.isOnlineFilter=K.IS_ONLINE_FILTER_ALL,this.order=K.ORDER_ALPHABETICAL}setLimit(e){this.limit=e}setReference(e){this.reference=e}load(e){let t,n;n={limit:this.limit,order:this.order},this.reference&&(n.reference=this.reference),this.userIds&&(n.user_ids=this.userIds),this.isActiveFilter&&(n.is_active_filter=this.isActiveFilter),this.isOnlineFilter&&(n.is_online_filter=this.isOnlineFilter),this.customFilter&&(n.custom_filter=this.customFilter),this.customFilterQueryType&&(n.custom_filter_query_type=this.customFilterQueryType),this.displayNameSearch&&(n.display_name_search=this.displayNameSearch),this.type===Y.ALL_USER?t=he.getInstance().transportManager.send({t:"users.list",d:n}):this.type===Y.BLOCKED_USER&&(t=he.getInstance().transportManager.send({t:"users.block_list",d:{limit:this.limit,reference:this.reference}}));let s=n=>(window.setTimeout(()=>{he.getInstance().off("to."+t+".success",s),he.getInstance().off("to."+t+".error",r)},0),n.length>0&&(this.reference=n[n.length-1].id),e(null,n)),r=n=>{let a=new O(n);return window.setTimeout(()=>{he.getInstance().off("to."+t+".success",s),he.getInstance().off("to."+t+".error",r)},0),e(a,null)};return he.getInstance().on("to."+t+".success",s),he.getInstance().on("to."+t+".error",r),!0}}class Z extends j{static create(e,t){let n={};e.getName()&&(n.name=e.getName()),e.getCustomFilter()&&(n.custom_filter=e.getCustomFilter()),e.getData()&&(n.data=e.getData()),e.getMetadata()&&(n.metadata=e.getMetadata()),e.getAvatarUrl()&&(n.avatar_url=e.getAvatarUrl()),e.getModeratorIds()&&(n.moderator_ids=e.getModeratorIds()),e.getAvatarFile()&&(n.avatar_file=e.getAvatarFile());let s=he.getInstance().transportManager.send({t:"open_channels.create",d:n}),r=e=>(window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(null,e)),a=e=>{let n=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(n,null)};he.getInstance().on("to."+s+".success",r),he.getInstance().on("to."+s+".error",a)}static get(e,t){return Z.cachedChannels&&Z.cachedChannels[e]?t(null,Z.cachedChannels[e]):this._getFromServer(e,t)}static _getFromServer(e,t){let n=he.getInstance().transportManager.send({t:"open_channels.get",d:{id:e}}),s=e=>(window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(null,e)),r=e=>{let a=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+n+".success",s),he.getInstance().off("to."+n+".error",r)},0),t(a,null)};he.getInstance().on("to."+n+".success",s),he.getInstance().on("to."+n+".error",r)}static _upsert(e){let t=new Z(e);Z.cachedChannels||(Z.cachedChannels={}),Z.cachedChannels[t.getId()]=t}update(e,t){let n={id:this.id};e.getName()&&(n.name=e.getName()),e.getCustomFilter()&&(n.custom_filter=e.getCustomFilter()),e.getData()&&(n.data=e.getData()),e.getMetadata()&&(n.metadata=e.getMetadata()),e.getAvatarUrl()&&(n.avatar_url=e.getAvatarUrl()),e.getAvatarFile()&&(n.avatar_file=e.getAvatarFile());let s=he.getInstance().transportManager.send({t:this.getType()+"_channels.update",d:n}),r=e=>(window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(null,e)),a=e=>{let n=new O(e);return window.setTimeout(()=>{he.getInstance().off("to."+s+".success",r),he.getInstance().off("to."+s+".error",a)},0),t(n,null)};he.getInstance().on("to."+s+".success",r),he.getInstance().on("to."+s+".error",a)}constructor(e){if(super(e),e.participants){this.participants=[];for(let t in e.participants)this.participants.push(new x(e.participants[t]))}if(e.participants_count?this.participantsCount=e.participants_count:this.participantsCount=0,this.moderators=[],e.moderators)for(let t in e.moderators)this.moderators.push(new L(e.moderators[t]))}getId(){return this.id}getName(){return this.name}static createOpenChannelListQuery(){return new X}createPreviousMessageListQuery(){return new B(this)}static purgeCache(){Z.cachedChannels={}}isModerator(e){if(!e)return this.moderator;if(this.moderators)for(let t in this.moderators)if(this.moderators[t].id===e)return!0;return!1}getModerators(){return this.moderators}getSerializedObject(){return JSON.parse(JSON.stringify(this))}static createFromSerializedObject(e){let t=S.traverseAndConvertCamelCase(e);return new Z(t)}}class ee extends V{constructor(){super()}}var te,ne=n(9),se=n.n(ne),re=n(2),ae=n.n(re);!function(e){e.HOST="wss://api.chatcamp.io",e.PORT="443"}(te||(te={}));var oe=class extends s{constructor(e){super(e),this.client=e.client,this.heartbeatFrequency=6e4,this._nextHeartbeatId=0,this.open=!1,this.timesOpened=0,this._reconnectDelay=1,this._maxReconnectDelay=120,this._listeners={},this.host=te.HOST,this.port=te.PORT,e.host&&(this.host=e.host),e.port&&(this.port=e.port),this._r=0}_connect(e){this.accessToken=e.accessToken,this.userId=e.userId;let t=te.HOST;if(this._socket)return;this.host!==te.HOST&&(t=this.host+":"+this.port);let n="?app_id="+this.client.app.id;he.getInstance().sessionKey?n="?session_key="+encodeURIComponent(he.getInstance().sessionKey):e.accessToken?n+="&user_id="+encodeURIComponent(e.userId)+"&access_token="+encodeURIComponent(e.accessToken):n+="&user_id="+encodeURIComponent(e.userId),this._socket=new se.a(t+"/chat/2.0"+n,{disableWebSocket:!1,disableEventSource:!0,disableXHRPolling:!1}),this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onDisconnect.bind(this),this._socket.ondisconnect=this._onDisconnect.bind(this),this._socket.onopen=this._onOpen.bind(this),this._socket.onerror=this._onError.bind(this),he.getInstance().setConnectionState(ce.CONNECTING)}setHost(e){this.host=e}setPort(e){this.port=e}_onOpen(){ae.a.debug("chat socket: opened",this._socket.transportType),this.open=!0,this.timesOpened++,this._rescheduleHeartbeat(),this.emit("open",null)}_onMessage(e){this._reconnectDelay=1,ae.a.debug("chat socket: message",typeof e);let t=JSON.parse(e.data);this.emit("message",t),ae.a.debug(t)}_onDisconnect(){this.open=!1,this.emit("close",null);let e=this;he.getInstance().setConnectionState(ce.CLOSED),q.purgeCache(),Z.purgeCache();let t=he.getInstance().getConnectionListenersMap();for(let e in t)t[e].onConnectionChanged(!1);window.setTimeout(function(){e._reconnectDelay<=e._maxReconnectDelay&&(e._reconnectDelay=2*e._reconnectDelay),e._reconnect()},this._reconnectDelay>this._maxReconnectDelay?1e3*this._maxReconnectDelay:1e3*this._reconnectDelay)}_onHeartbeat(){this.send({t:"ping"})}_onClose(){}_onError(e){let t="iflychat.app.ws.error";0!==this._socket.transportType&&(t="iflychat.app.poll.error")}send(e){return this._r++,e.r=this._r,e.l&&(this._listeners["r_"+e.r]=e.l,delete e.l),this.open&&this._socket.send(JSON.stringify(e)),this._r}_rescheduleHeartbeat(){this._nextHeartbeatId&&clearTimeout(this._nextHeartbeatId),this._nextHeartbeatId=window.setTimeout(this._heartbeat.bind(this),this.heartbeatFrequency)}_heartbeat(){this._nextHeartbeatId=0,this.send({t:"ping"}),this._rescheduleHeartbeat()}_reconnect(){if(this._socket=null,this.open=!1,clearTimeout(this._nextHeartbeatId),he.getInstance().setConnectionState(ce.CLOSED),!this.client.hasUserForcedDisconnect()&&this.client.isAutoReconnectEnabled()){let e,t=null;if(this.client.user&&this.client.user.accessToken&&this.client.user.id?(t=this.client.user.accessToken,e=this.client.user.id):this.client.user&&this.client.user.id?e=this.client.user.id:this.userId&&this.accessToken?(t=this.accessToken,e=this.userId):this.userId&&(e=this.userId),e&&t)return this._connect({userId:e,accessToken:t}),!0;if(e)return this._connect({userId:e}),!0}return!1}disconnect(e){he.getInstance().setConnectionState(ce.CLOSING),this._socket&&this._socket.close(1e3,"Normal Closure"),e()}};var ie,ce,ue=class extends s{constructor(e,t){super(),he.getInstance().transportManager.on("message",this._handleMessage.bind(this))}_handleMessage(e){switch(e.t){case"app.get.ack":this._handleAppInfo(e);break;case"group_channels.active.ack":case"open_channels.active.ack":this._handleBaseChannelsActiveAck(e.d,e.to);break;case"group_channels.ban.ack":case"open_channels.ban.ack":this._handleBaseChannelsBanAck(e.d,e.to);break;case"group_channels.ban.pub":case"open_channels.ban.pub":this._handleBaseChannelsBanPub(e.d,e.to);break;case"group_channels.unban.ack":case"open_channels.unban.ack":this._handleBaseChannelsUnbanAck(e.d,e.to);break;case"group_channels.unban.pub":case"open_channels.unban.pub":this._handleBaseChannelsUnbanPub(e.d,e.to);break;case"group_channels.ban_list.ack":case"open_channels.ban_list.ack":this._handleBaseChannelsBanListAck(e.d,e.to);break;case"group_channels.delete.ack":case"open_channels.delete.ack":this._handleBaseChannelsDeleteAck(e.d,e.to);break;case"group_channels.delete.pub":case"open_channels.delete.pub":this._handleBaseChannelsDeletePub(e.d,e.to);break;case"group_channels.mute.ack":case"open_channels.mute.ack":this._handleBaseChannelsMuteAck(e.d,e.to);break;case"group_channels.mute.pub":case"open_channels.mute.pub":this._handleBaseChannelsMutePub(e.d,e.to);break;case"group_channels.unmute.ack":case"open_channels.unmute.ack":this._handleGroupChannelsUnmuteAck(e.d,e.to);break;case"group_channels.unmute.pub":case"open_channels.unmute.pub":this._handleGroupChannelsUnmutePub(e.d,e.to);break;case"group_channels.mute_list.ack":case"open_channels.mute_list.ack":this._handleBaseChannelsMuteListAck(e.d,e.to);break;case"group_channels.create.ack":case"open_channels.create.ack":this._handleBaseChannelsCreateAck(e.d,e.to);break;case"group_channels.history.ack":case"open_channels.history.ack":this._handleBaseChannelsHistoryAck(e.d,e.to);break;case"group_channels.get.ack":case"open_channels.get.ack":this._handleBaseChannelsGetAck(e.d,e.to);break;case"group_channels.update.ack":case"open_channels.update.ack":this._handleBaseChannelsCreateAck(e.d,e.to);break;case"group_channels.update.pub":case"open_channels.update.pub":this._handleBaseChannelsUpdatePub(e.d);break;case"group_channels.clear_history.ack":case"open_channels.clear_history.ack":this._handleBaseChannelsClearHistoryAck(e.d,e.to);break;case"group_channels.clear_history.pub":case"open_channels.clear_history.pub":this._handleBaseChannelsClearHistoryPub(e.d,e.to);break;case"group_channels.join.ack":case"open_channels.join.ack":this._handleBaseChannelsJoinAck(e.d,e.to);break;case"group_channels.join.pub":case"open_channels.join.pub":this._handleBaseChannelsJoinPub(e.d,e.to);break;case"group_channels.leave.ack":case"open_channels.leave.ack":this._handleBaseChannelsLeaveAck(e.d,e.to);break;case"group_channels.leave.pub":case"open_channels.leave.pub":this._handleBaseChannelsLeavePub(e.d);break;case"group_channels.list.ack":case"open_channels.list.ack":this._handleBaseChannelsListAck(e.d,e.to);break;case"group_channels.message.ack":case"open_channels.message.ack":this._handleBaseChannelsMessageAck(e.d,e.to);break;case"group_channels.message.pub":case"open_channels.message.pub":this._handleBaseChannelsMessagePub(e.d,e.to);break;case"group_channels.message_get.ack":case"open_channels.message_get.ack":this._handleBaseChannelsMessageGetAck(e.d,e.to);break;case"group_channels.message_update.ack":case"open_channels.message_update.ack":this._handleBaseChannelsMessageUpdateAck(e.d,e.to);break;case"group_channels.message_update.pub":case"open_channels.message_update.pub":this._handleBaseChannelsMessageUpdatePub(e.d,e.to);break;case"group_channels.messages_count.ack":case"open_channels.messages_count.ack":this._handleBaseChannelsMessagesCountAck(e.d,e.to);break;case"group_channels.moderators_add.ack":case"open_channels.moderators_add.ack":this._handleBaseChannelsModeratorsAddAck(e.d,e.to);break;case"group_channels.moderators_add.pub":case"open_channels.moderators_add.pub":this._handleBaseChannelsModeratorsAddPub(e.d,e.to);break;case"group_channels.moderators_list.ack":case"open_channels.moderators_list.ack":this._handleBaseChannelsModeratorsListAck(e.d,e.to);break;case"group_channels.moderators_remove.ack":case"open_channels.moderators_remove.ack":this._handleBaseChannelsModeratorsRemoveAck(e.d,e.to);break;case"group_channels.moderators_remove.pub":case"open_channels.moderators_remove.pub":this._handleBaseChannelsModeratorsRemovePub(e.d,e.to);break;case"group_channels.message_delete.ack":case"open_channels.message_delete.ack":this._handleBaseChannelsMessageDeleteAck(e.d,e.to);break;case"group_channels.participants_list.ack":case"open_channels.participants_list.ack":this._handleBaseChannelsParticipantsListAck(e.d,e.to);break;case"group_channels.view_only.ack":case"open_channels.view_only.ack":this._handleBaseChannelsViewOnlyAck(e.d,e.to);break;case"group_channels.archive.ack":this._handleGroupChannelsArchiveAck(e.d,e.to);break;case"group_channels.archive.pub":this._handleGroupChannelsArchivePub(e.d,e.to);break;case"group_channels.invite.ack":this._handleGroupChannelsInviteAck(e.d,e.to);break;case"group_channels.accept.ack":this._handleGroupChannelsAcceptAck(e.d,e.to);break;case"group_channels.invite.pub":this._handleGroupChannelsInvitePub(e.d);break;case"group_channels.accept.pub":this._handleGroupChannelsAcceptPub(e.d);break;case"group_channels.decline.ack":this._handleGroupChannelsDeclineAck(e.d,e.to);break;case"group_channels.decline.pub":this._handleGroupChannelsDeclinePub(e.d);break;case"group_channels.my_list.ack":this._handleGroupChannelMyListAck(e.d,e.to);break;case"group_channels.my_list_count.ack":this._handleGroupChannelsMyListCountAck(e.d,e.to);break;case"group_channels.message_delete.pub":this._handleBaseChannelsMessageDeletePub(e.d,e.to);break;case"group_channels.start_typing.pub":this._handleGroupChannelsStartTypingPub(e.d,e.to);break;case"group_channels.start_typing.ack":break;case"group_channels.stop_typing.pub":this._handleGroupChannelsStopTypingPub(e.d,e.to);break;case"group_channels.stop_typing.ack":break;case"group_channels.read.ack":this._handleGroupChannelsReadAck(e.d,e.to);break;case"group_channels.read.pub":this._handleGroupChannelsReadPub(e.d);break;case"users.auth.ack":this._handleUsersAuthAck(e.d,e.to);break;case"users.get.ack":case"users.update.ack":this._handleUsersUpdateAck(e.d,e.to);break;case"users.block_list.ack":this._handleUsersBlockListAck(e.d,e.to);break;case"users.list.ack":this._handleUsersListAck(e.d,e.to);break;case"users.block.ack":this._handleUsersBlockAck(e.d,e.to);break;case"users.get_total_unread_message_count.ack":this._handleUsersGetTotalUnreadMessageCountAck(e.d,e.to);break;case"users.get_total_unread_group_channel_count.ack":this._handleUsersGetTotalUnreadGroupChannelCountAck(e.d,e.to);break;case"users.mark_as_read_all.ack":this._handleUsersMarkAsReadAllAck(e.d,e.to);break;case"users.push_notification_snooze_get.ack":this._handleUsersPushNotificationSnoozeGetAck(e.d,e.to);break;case"users.push_notification_snooze_update.ack":this._handleUsersPushNotificationSnoozeUpdateAck(e.d,e.to);break;case"users.push_notification_sound_get.ack":this._handleUsersPushNotificationSoundGetAck(e.d,e.to);break;case"users.push_notification_sound_update.ack":this._handleUsersPushNotificationSoundUpdateAck(e.d,e.to);break;case"users.push_notification_template_get.ack":this._handleUsersPushNotificationTemplateGetAck(e.d,e.to);break;case"users.push_notification_template_update.ack":this._handleUsersPushNotificationTemplateUpdateAck(e.d,e.to);break;case"users.push_preference_get.ack":this._handleUsersPushNotificationPreferenceGetAck(e.d,e.to);break;case"users.push_preference_update.ack":this._handleUsersPushNotificationPreferenceUpdateAck(e.d,e.to);break;case"users.push_token_update.ack":this._handleUsersPushTokenUpdateAck(e.d,e.to);break;case"users.push_token_delete.ack":this._handleUsersPushTokenDeleteAck(e.d,e.to);break;case"users.unblock.ack":this._handleUsersUnblockAck(e.d,e.to);break;default:he.getInstance().emit(e.t,e.d)}}_handleAppInfo(e){e.d.ok&&(he.getInstance().app=new M({id:e.d.app.id,name:e.d.app.name,notification:e.d.app.notification,theme:e.d.app.theme}))}_handleBaseChannelsActiveAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelsArchiveAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelsArchivePub(e,t){if(e.ok){let t,n;e.group_channel&&(t=e.group_channel,n=new q(t),q._upsert(t));for(let e in he.getInstance().getChannelListenersMap()){let t=he.getInstance().getChannelListenersMap()[e];n.isArchived?t.onArchived(n):t.onUnarchived(n)}}}_handleBaseChannelsBanAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsBanPub(e,t){if(e.ok){let t,n;e.group_channel?(t=e.group_channel,n=new q(t),q._upsert(t)):e.open_channel&&(t=e.open_channel,n=new Z(t),Z._upsert(t));let s=new L(e.banned_participant);for(let e in he.getInstance().getChannelListenersMap()){let t=he.getInstance().getChannelListenersMap()[e];t.onParticipantBanned(n,s),t.onChannelUpdated(n)}}}_handleBaseChannelsUnbanAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsUnbanPub(e,t){if(e.ok){let t,n;e.group_channel?(t=e.group_channel,n=new q(t),q._upsert(t)):e.open_channel&&(t=e.open_channel,n=new Z(t),Z._upsert(t));let s=new L(e.unbanned_participant);for(let e in he.getInstance().getChannelListenersMap()){let t=he.getInstance().getChannelListenersMap()[e];t.onParticipantUnbanned(n,s),t.onChannelUpdated(n)}}}_handleBaseChannelsBanListAck(e,t){if(e.ok){let n;e.open_channel?n=e.open_channel.banned_participants:e.group_channel&&(n=e.group_channel.banned_participants);let s=[];for(let e in n){let t=new L(n[e]);s.push(t)}t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsDeleteAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsDeletePub(e,t){if(e.ok){let t;e.group_channel?(t=e.group_channel,delete q.cachedChannels[t.id]):e.open_channel&&(t=e.open_channel,delete q.cachedChannels[t.id]);let n=t.id;for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onChannelDeleted(n)}}_handleBaseChannelsMuteAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsMutePub(e,t){if(e.ok){let t,n;e.group_channel?(t=e.group_channel,n=new q(t),q._upsert(t)):e.open_channel&&(t=e.open_channel,n=new Z(t),Z._upsert(t));let s=new L(e.muted_participant);for(let e in he.getInstance().getChannelListenersMap()){let t=he.getInstance().getChannelListenersMap()[e];t.onParticipantMuted(n,s),t.onChannelUpdated(n)}}}_handleGroupChannelsUnmuteAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelsUnmutePub(e,t){if(e.ok){let t,n;e.group_channel?(t=e.group_channel,n=new q(t),q._upsert(t)):e.open_channel&&(t=e.open_channel,n=new Z(t),Z._upsert(t));let s=new L(e.unmuted_participant);for(let e in he.getInstance().getChannelListenersMap()){let t=he.getInstance().getChannelListenersMap()[e];t.onParticipantUnmuted(n,s),t.onChannelUpdated(n)}}}_handleBaseChannelsMuteListAck(e,t){if(e.ok){let n;e.open_channel?n=e.open_channel.muted_participants:e.group_channel&&(n=e.group_channel.muted_participants);let s=[];for(let e in n){let t=new L(n[e]);s.push(t)}t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsClearHistoryAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsClearHistoryPub(e,t){if(e.ok){let t,n;e.group_channel?(t=e.group_channel,n=new q(t),q._upsert(t)):e.open_channel&&(t=e.open_channel,n=new Z(t),Z._upsert(t));for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onHistoryCleared(n)}}_handleGroupChannelsInviteAck(e,t){if(e.ok){let n=e.group_channel,s=new q(n);t&&he.getInstance().emit("to."+t+".success",s)}}_handleGroupChannelsAcceptAck(e,t){if(e.ok){let n=e.group_channel,s=new q(n);t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelsInvitePub(e){if(e.ok){let t=e.group_channel,n=e.users,s=new q(t);for(let e in he.getInstance().getChannelListenersMap()){let t=he.getInstance().getChannelListenersMap()[e];for(let e in n){let r=new x(n[e]);t.onParticipantInvited(s,r)}}}}_handleGroupChannelsAcceptPub(e){if(e.ok){let t=e.group_channel,n=e.users,s=new q(t);q._upsert(t);for(let e in n){let t=new x(n[e]);t.id===he.getInstance().user.id&&this._updateTotalGroupChannelCount(s,1,!1);for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onParticipantJoined(s,t)}}}_handleGroupChannelsDeclineAck(e,t){if(e.ok){let n=e.group_channel,s=new q(n);t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelsDeclinePub(e){if(e.ok){let t=e.group_channel,n=e.users,s=new q(t);q._upsert(t);for(let e in he.getInstance().getChannelListenersMap()){let t=he.getInstance().getChannelListenersMap()[e];for(let e in n){let r=new x(n[e]);t.onParticipantDeclined(s,r)}}}}_handleBaseChannelsLeaveAck(e,t){if(e.ok){let n,s;e.group_channel?(n=e.group_channel,s=new q(n),q._upsert(n),this._updateTotalGroupChannelCount(s,-1,!1)):e.open_channel&&(n=e.open_channel,s=new Z(n),Z._upsert(n)),t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsLeavePub(e){if(e.ok){let t,n;e.group_channel?(t=e.group_channel,n=new q(t),q._upsert(t)):e.open_channel&&(t=e.open_channel,n=new Z(t),Z._upsert(t));let s=e.users;for(let e in he.getInstance().getChannelListenersMap()){let t=he.getInstance().getChannelListenersMap()[e];for(let e in s){let r=new x(s[e]);t.onParticipantLeft(n,r)}}}}_handleBaseChannelsCreateAck(e,t){if(e.ok){let n,s;e.group_channel?(n=e.group_channel,s=new q(n)):e.open_channel&&(n=e.open_channel,s=new Z(n)),t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsHistoryAck(e,t){if(e.ok){let n=e.messages,s=[];for(let e in n){let t=new P(n[e]);s.push(t)}t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsGetAck(e,t){if(e.ok){let n,s;e.group_channel?(n=e.group_channel,s=new q(n),q._upsert(n)):e.open_channel&&(n=e.open_channel,s=new Z(n),Z._upsert(n)),t&&he.getInstance().emit("to."+t+".success",s)}else e.error,t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsUpdatePub(e){if(e.ok){let t;if(e.group_channel){t=e.group_channel;let n=new q(t);q._upsert(t),q.get(n.getId(),function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onChannelUpdated(t)})}else if(e.open_channel){t=e.open_channel;let n=new Z(t);Z._upsert(t),Z.get(n.getId(),function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onChannelUpdated(t)})}}}_handleGroupChannelMyListAck(e,t){if(e.ok){let n=e.group_channels,s=[];for(let e in n){let t=new q(n[e]);s.push(t),q._upsert(n[e])}t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelsMyListCountAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",e.group_channel.count):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsMessageAck(e,t){if(e.ok){let n=e.message,s=new P(n);n.channel_id,t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsMessagePub(e,t){if(e.ok){let t=e.message,n=new P(t),s=t.channel_id;if("group_channel"===t.channel_type){let e=!1;q.cachedChannels[s]&&(e=!0);let t=this;q.get(s,function(s,r){e?(r.lastMessage=n,"announcement"!==n.type&&he.getInstance().user.id===n.user.id||(r.unreadMessageCount+=1,t._updateTotalUnreadMessageCount(r,1,!1),1===r.unreadMessageCount&&t._updateTotalUnreadGroupChannelCount(r,1,!1)),q.cachedChannels[r.getId()]=r):(t._updateTotalUnreadMessageCount(r,1,!1),1===r.unreadMessageCount&&t._updateTotalUnreadGroupChannelCount(r,1,!1));for(let e in he.getInstance().getChannelListenersMap()){let t=he.getInstance().getChannelListenersMap()[e];t.onMessageReceived(r,n),t.onChannelUpdated(r)}})}else Z.get(s,function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onMessageReceived(t,n)})}}_handleBaseChannelsMessageDeleteAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsMessagesCountAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",e.message.count):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsMessageDeletePub(e,t){if(e.ok){let t=e.message,n=new P(t),s=t.channel_id;"group_channel"===t.channel_type?q.get(s,function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onMessageDeleted(t,n)}):Z.get(s,function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onMessageDeleted(t,n)})}}_handleBaseChannelsMessageGetAck(e,t){if(e.ok){let n=e.message,s=new P(n);n.channel_id,t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsMessageUpdateAck(e,t){if(e.ok){let n=e.message,s=new P(n);n.channel_id,t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsMessageUpdatePub(e,t){if(e.ok){let t=e.message,n=new P(t),s=t.channel_id;"group_channel"===t.channel_type?q.get(s,function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onMessageUpdated(t,n)}):Z.get(s,function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onMessageUpdated(t,n)})}}_handleBaseChannelsModeratorsAddAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsModeratorsAddPub(e,t){if(e.ok){let t,n;e.group_channel?(t=e.group_channel,n=new q(t),q._upsert(t),q.get(n.getId(),function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onChannelUpdated(t)})):e.open_channel&&(t=e.open_channel,n=new Z(t),Z._upsert(t),Z.get(n.getId(),function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onChannelUpdated(t)}))}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsModeratorsListAck(e,t){if(e.ok){let n;e.group_channel?n=e.group_channel.moderators:e.open_channel&&(n=e.open_channel.moderators);let s=[];for(let e in n){let t=new L(n[e]);s.push(t)}t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsModeratorsRemoveAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsModeratorsRemovePub(e,t){if(e.ok){let t,n;e.group_channel?(t=e.group_channel,n=new q(t),q._upsert(t),q.get(n.getId(),function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onChannelUpdated(t)})):e.open_channel&&(t=e.open_channel,n=new Z(t),Z._upsert(t),Z.get(n.getId(),function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onChannelUpdated(t)}))}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsParticipantsListAck(e,t){if(e.ok){let n;e.group_channel?n=e.group_channel.participants:e.open_channel&&(n=e.open_channel.participants);let s=[];for(let e in n){let t=new x(n[e]);s.push(t)}t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelsStartTypingPub(e,t){if(e.ok){let t=e.group_channel.typing_participant_id,n=e.group_channel.id;q.get(n,function(e,n){n.setTypingStatus(t,!0);for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onTypingStatusChanged(n)})}}_handleGroupChannelsStopTypingPub(e,t){if(e.ok){let t=e.group_channel.typing_participant_id,n=e.group_channel.id;q.get(n,function(e,n){n.setTypingStatus(t,!1);for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onTypingStatusChanged(n)})}}_handleGroupChannelsReadAck(e,t){if(e.ok){let t=e.group_channel,n=new q(t),s=!1;q.cachedChannels[t.id]&&(s=!0);let r=this;if(s){let e=he.getInstance().user.id,n=q.cachedChannels[t.id];t.read_receipt[e]&&t.read_receipt[e]>=n.lastMessage.insertedAt?(t.unread_message_count=0,r._updateTotalUnreadMessageCount(n,0,!0),n.unreadMessageCount>0&&r._updateTotalUnreadGroupChannelCount(n,-1,!1)):t.unread_message_count=q.cachedChannels[t.id].unreadMessageCount}q._upsert(t),q.get(n.getId(),function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onChannelUpdated(t)})}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelsReadPub(e){if(e.ok){let t=e.group_channel,n=!1;q.cachedChannels[t.id]&&(n=!0);let s=this;if(n){let e=he.getInstance().user.id,n=q.cachedChannels[t.id];t.read_receipt[e]&&t.read_receipt[e]>=n.lastMessage.insertedAt?(t.unread_message_count=0,s._updateTotalUnreadMessageCount(n,0,!0),n.unreadMessageCount>0&&s._updateTotalUnreadGroupChannelCount(n,-1,!1)):t.unread_message_count=q.cachedChannels[t.id].unreadMessageCount,q._upsert(t)}q.get(t.id,function(e,t){for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onReadStatusUpdated(t)})}}_handleBaseChannelsViewOnlyAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsJoinAck(e,t){if(e.ok){let n,s;e.group_channel?(n=e.group_channel,s=new q(n)):e.open_channel&&(n=e.open_channel,s=new Z(n)),t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleBaseChannelsJoinPub(e,t){if(e.ok){let t,n;e.group_channel?(t=e.group_channel,n=new q(t)):e.open_channel&&(t=e.open_channel,n=new Z(t));let s=e.users[0],r=new x(s);for(let e in he.getInstance().getChannelListenersMap())he.getInstance().getChannelListenersMap()[e].onParticipantJoined(n,r)}}_handleBaseChannelsListAck(e,t){if(e.ok){let n;e.open_channels?n=e.open_channels:e.group_channels&&(n=e.group_channels);let s=[];for(let t in n)if(e.open_channels){let e=new Z(n[t]);s.push(e),Z._upsert(e)}else if(e.group_channels){let e=new q(n[t]);s.push(e),q._upsert(e)}t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersAuthAck(e,t){if(e.ok){this._setUser(e.user),he.getInstance().sessionKey=e.session_key,he.getInstance().setConnectionState(ce.OPEN),t&&he.getInstance().transportManager._listeners["r_"+t]&&(he.getInstance().transportManager._listeners["r_"+t](null,he.getInstance().user),delete he.getInstance().transportManager._listeners["r_"+t]);for(let e of he.getInstance().connectListeners)e(null,he.getInstance().user);he.getInstance().connectListeners=[];let n=he.getInstance().getConnectionListenersMap();for(let e in n)n[e].onConnectionChanged(!0)}else{he.getInstance().sessionKey&&(he.getInstance().sessionKey=null),t&&he.getInstance().emit("to."+t+".error",e.error);for(let t of he.getInstance().connectListeners)t(new O(e.error),null);he.getInstance().connectListeners=[]}}_handleUsersUpdateAck(e,t){e.ok?e.user.id===he.getInstance().user.id&&(this._setUser(e.user),t&&he.getInstance().emit("to."+t+".success",he.getInstance().user)):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersListAck(e,t){if(e.ok){let n=e.users,s=[];for(let e in n){let t=new L(n[e]);s.push(t)}t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersBlockListAck(e,t){if(e.ok){let n=e.users,s=[];for(let e in n){let t=new L(n[e]);s.push(t)}t&&he.getInstance().emit("to."+t+".success",s)}else t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersBlockAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",new L(e.user)):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersGetTotalUnreadMessageCountAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",e.user.unread_message_count):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersGetTotalUnreadGroupChannelCountAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",e.user.unread_group_channel_count):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersMarkAsReadAllAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationPreferenceGetAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",e.user):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationPreferenceUpdateAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationTemplateGetAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",e.user.push_notification_template):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationTemplateUpdateAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationSnoozeUpdateAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationSnoozeGetAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",e.user.push_notification_snooze):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationSoundGetAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",e.user.push_notification_sound):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationSoundUpdateAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushTokenUpdateAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",he.getInstance().user):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushTokenDeleteAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",null):t&&he.getInstance().emit("to."+t+".error",e.error)}_handleUsersUnblockAck(e,t){e.ok?t&&he.getInstance().emit("to."+t+".success",new L(e.user)):t&&he.getInstance().emit("to."+t+".error",e.error)}_setUser(e){he.getInstance().user=new L(e)}_updateTotalUnreadMessageCount(e,t,n=!1){for(let s in he.getInstance().cachedTotalUnreadMessageCount){let{count:r,params:a}=he.getInstance().cachedTotalUnreadMessageCount[s];if(0==a.getCustomFilter().length||!e.getCustomFilter().some(e=>-1===a.getCustomFilter().indexOf(e))){n?he.getInstance().cachedTotalUnreadMessageCount[s].count=0:he.getInstance().cachedTotalUnreadMessageCount[s].count+=t;for(let e in he.getInstance().getUserListenersMap()){let{count:t,params:n}=he.getInstance().cachedTotalUnreadMessageCount[s];he.getInstance().getUserListenersMap()[e].onTotalUnreadMessageCount(t,n)}}}}_updateTotalUnreadGroupChannelCount(e,t,n=!1){for(let s in he.getInstance().cachedTotalUnreadGroupChannelCount){let{count:r,params:a}=he.getInstance().cachedTotalUnreadGroupChannelCount[s];if(0==a.getCustomFilter().length||!e.getCustomFilter().some(e=>-1===a.getCustomFilter().indexOf(e))){n?he.getInstance().cachedTotalUnreadGroupChannelCount[s].count=0:he.getInstance().cachedTotalUnreadGroupChannelCount[s].count+=t;for(let e in he.getInstance().getUserListenersMap()){let{count:t,params:n}=he.getInstance().cachedTotalUnreadGroupChannelCount[s];he.getInstance().getUserListenersMap()[e].onTotalUnreadGroupChannelCount(t,n)}}}}_updateTotalGroupChannelCount(e,t,n=!1){for(let s in q.cachedTotalGroupChannelCount){let{count:r,params:a}=q.cachedTotalGroupChannelCount[s];if(0==a.getCustomFilter().length||!e.getCustomFilter().some(e=>-1===a.getCustomFilter().indexOf(e))){n?q.cachedTotalGroupChannelCount[s].count=0:q.cachedTotalGroupChannelCount[s].count+=t;for(let e in he.getInstance().getChannelListenersMap()){let{count:t,params:n}=q.cachedTotalGroupChannelCount[s];he.getInstance().getChannelListenersMap()[e].onTotalChannelCount(t,n)}}}}};n.d(t,"ClientPushNotificationTemplate",function(){return ie}),n.d(t,"ClientConnectionState",function(){return ce}),function(e){e.DEFAULT="DEFAULT",e.PRIVATE="PRIVATE"}(ie||(ie={})),function(e){e[e.OPEN=0]="OPEN",e[e.CONNECTING=1]="CONNECTING",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(ce||(ce={}));class le extends s{constructor(e){super(e),this.connectionState=ce.CLOSED,this.connectListeners=[],this.cachedTotalUnreadGroupChannelCount={},this.baseUrl="https://api.chatcamp.io/client-api/2.0",v.a.defaults.withCredentials=!0;let t=le.getInstance();if(t)return t;this.sessionKey=null,this.channelListeners={},this.connectionListeners={},this.userListeners={},this.cachedTotalUnreadMessageCount={},this.autoReconnectEnabled=!0,this.userForceToDisconnect=!1,this.tick=window.setInterval(()=>{let e=q.cachedChannels;for(let t in e){if(e[t].checkTypingStatus())for(let n in le.getInstance().getChannelListenersMap()){le.getInstance().getChannelListenersMap()[n].onTypingStatusChanged(e[t])}}},1e3),this.app=new M(e),this.GroupChannel=q,this.GroupChannelParams=Q,this.OpenChannel=Z,this.OpenChannelParams=ee,this.Message=P,this.MessageParams=F,this.GroupChannelListQuery=D,this.OpenChannelListQuery=X,this.ChannelListener=W,this.ConnectionListener=z,this.UserListener=J,this.User=L,this.ThumbnailDimension=N,this.Participant=x,le.instance=this}static getInstance(){return le.instance}connect(...e){2==arguments.length?"string"==typeof arguments[0]&&(arguments[1],1)&&this.connectUser(arguments[0],arguments[1]):3==arguments.length?"string"==typeof arguments[0]&&"string"==typeof arguments[1]&&(arguments[2],1)?this.connectUserWithAccessToken(arguments[0],arguments[1],arguments[2]):"string"==typeof arguments[0]&&void 0===arguments[1]&&(arguments[2],1)&&this.connectUser(arguments[0],arguments[2]):4==arguments.length?"string"==typeof arguments[0]&&"string"==typeof arguments[1]&&"string"==typeof arguments[2]&&"function"==typeof arguments[3]&&this.customConnectUser(arguments[0],arguments[1],arguments[2],arguments[3]):5==arguments.length&&("string"==typeof arguments[0]&&"string"==typeof arguments[1]&&"string"==typeof arguments[2]&&"string"==typeof arguments[3]&&"function"==typeof arguments[4]?this.customConnectUserWithAccessToken(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]):"string"==typeof arguments[0]&&void 0===arguments[1]&&"string"==typeof arguments[2]&&"string"==typeof arguments[3]&&"function"==typeof arguments[4]&&this.customConnectUser(arguments[0],arguments[2],arguments[3],arguments[4]))}connectUser(e,t){return this._connect({userId:e},t)}connectUserWithAccessToken(e,t,n){return this._connect({userId:e,accessToken:t},n)}customConnectUser(e,t,n,s){return"443"===n?(this.baseUrl="https://"+t+":"+n+"/client-api/2.0",t="wss://"+t):(this.baseUrl="http://"+t+":"+n+"/client-api/2.0",t="ws://"+t),this._connect({userId:e,host:t,port:n},s)}customConnectUserWithAccessToken(e,t,n,s,r){return"443"===s?(this.baseUrl="https://"+n+":"+s+"/client-api/2.0",n="wss://"+n):(this.baseUrl="http://"+n+":"+s+"/client-api/2.0",n="ws://"+n),this._connect({userId:e,accessToken:t,host:n,port:s},r)}_connect(e,t){if(this.getConnectionState()===ce.OPEN)t(null,this.user);else if(this.getConnectionState()==ce.CONNECTING)this.connectListeners.push(t);else{let n;this.userForceToDisconnect=!1,n={client:this,app_id:this.app.id,userId:e.userId},e.accessToken&&(n.accessToken=e.accessToken),e.host&&e.port&&(n.host=e.host,n.port=e.port),this.transportManager||(this.transportManager=new oe(n)),this.connectListeners.push(t),this.transportManager._connect(n),this.eventManager||(this.eventManager=new ue(this,this.transportManager))}}_clientApiPost(e,t,n){var s=new FormData;for(let e in t)if("object"==typeof t[e]&&"avatar_file"!==e){let n=t[e];for(let t in n)Array.isArray(n)?s.append(e+"[]",n[t]):s.append(e+"["+t+"]",n[t])}else s.append(e,t[e]);let r={headers:{"content-type":"multipart/form-data","x-session-key":le.getInstance().sessionKey},onUploadProgress:e=>{}};return v.a.post(le.getInstance().baseUrl+e,s,r).then(e=>n(null,e)).catch(e=>n(e,null)),!0}_uploadAttachment(e,t,n){let s=new FormData;s.append("channel_type",e.channelType),s.append("channel_id",e.channelId),s.append("file",e.file),s.append("type","MESSAGE_ATTACHMENT"),e.thumbnails&&s.append("thumbnails",JSON.stringify(e.thumbnails)),this.sessionKey&&s.append("user_access_token",this.user.accessToken);let r={headers:{"content-type":"multipart/form-data","x-session-key":this.sessionKey},onUploadProgress:e=>{t(e.loaded,e.total)}};v.a.post(this.baseUrl+"/files.upload",s,r).then(e=>e.data&&e.data.file?n(null,e.data.file):n(!0,null)).catch(e=>n(e,null))}getConnectionState(){return this.connectionState}setConnectionState(e){this.connectionState=e}updateUserDisplayName(e,t){return this._updateDisplayNameOnServer(e,t)}updateUserProfileUrl(e,t){return this._updateProfileUrlOnServer(e,t)}updateUserAvatarUrl(e,t){return this._updateAvatarUrlOnServer(e,t)}uploadUserAvatar(e,t,n){let s=new FormData;s.append("app_id",this.app.id),s.append("user_id",this.user.id),this.user.accessToken&&s.append("user_access_token",this.user.accessToken),s.append("avatar",e);let r={headers:{"content-type":"multipart/form-data"},onUploadProgress:e=>{t(e.loaded,e.total)}};v.a.post(this.baseUrl+"/avatar_upload",s,r).then(e=>e.data&&e.data.user?n(null,new L(e.data.user)):n(e.data.error,null)).catch(e=>n(e,null))}updateUserData(e,t){let n={id:this.user.id,data:e};return this._updateUserOnServer(n,t)}updateUserMetadata(e,t){return this._updateMetadataOnServer(e,t)}addChannelListener(e,t){this.channelListeners[e]=t}addConnectionListener(e,t){this.connectionListeners[e]=t}addUserListener(e,t){this.userListeners[e]=t}removeChannelListener(e){delete this.channelListeners[e]}removeConnectionListener(e){delete this.connectionListeners[e]}removeUserListener(e){delete this.userListeners[e]}getChannelListenersMap(){return this.channelListeners}getConnectionListenersMap(){return this.connectionListeners}getUserListenersMap(){return this.userListeners}createUserListQuery(){return new $(Y.ALL_USER)}createBlockedUserListQuery(){return new $(Y.BLOCKED_USER)}setAutoReconnectEnabled(e){this.autoReconnectEnabled=e}isAutoReconnectEnabled(){return this.autoReconnectEnabled}hasUserForcedDisconnect(){return this.userForceToDisconnect}disconnect(e){this.userForceToDisconnect=!0,this.transportManager.disconnect(e)}blockUser(e,t){let n=this.transportManager.send({t:"users.block",d:{block_id:e}}),s=e=>(window.setTimeout(()=>{le.getInstance().off("to."+n+".success",s),le.getInstance().off("to."+n+".error",r)},0),t(null,e)),r=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+n+".success",s),le.getInstance().off("to."+n+".error",r)},0),t(e,null)};return le.getInstance().on("to."+n+".success",s),le.getInstance().on("to."+n+".error",r),!0}unblockUser(e,t){let n=this.transportManager.send({t:"users.unblock",d:{unblock_id:e}}),s=e=>(window.setTimeout(()=>{le.getInstance().off("to."+n+".success",s),le.getInstance().off("to."+n+".error",r)},0),t(null,e)),r=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+n+".success",s),le.getInstance().off("to."+n+".error",r)},0),t(e,null)};return le.getInstance().on("to."+n+".success",s),le.getInstance().on("to."+n+".error",r),!0}updatePushNotificationTemplate(e,t){let n=this.transportManager.send({t:"users.push_notification_template_update",d:{push_notification_template:e}}),s=()=>(window.setTimeout(()=>{le.getInstance().off("to."+n+".success",s),le.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+n+".success",s),le.getInstance().off("to."+n+".error",r)},0),t(e)};return le.getInstance().on("to."+n+".success",s),le.getInstance().on("to."+n+".error",r),!0}getPushNotificationTemplate(e){let t=this.transportManager.send({t:"users.push_notification_template_get",d:{}}),n=r=>(window.setTimeout(()=>{le.getInstance().off("to."+t+".success",n),le.getInstance().off("to."+t+".error",s)},0),e(null,r)),s=r=>{new O(r);return window.setTimeout(()=>{le.getInstance().off("to."+t+".success",n),le.getInstance().off("to."+t+".error",s)},0),e(r,null)};return le.getInstance().on("to."+t+".success",n),le.getInstance().on("to."+t+".error",s),!0}updatePushNotificationSound(e,t){let n=this.transportManager.send({t:"users.push_notification_sound_update",d:{push_notification_sound:e}}),s=()=>(window.setTimeout(()=>{le.getInstance().off("to."+n+".success",s),le.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+n+".success",s),le.getInstance().off("to."+n+".error",r)},0),t(e)};return le.getInstance().on("to."+n+".success",s),le.getInstance().on("to."+n+".error",r),!0}getPushNotificationSound(e){let t=this.transportManager.send({t:"users.push_notification_sound_get",d:{}}),n=r=>(window.setTimeout(()=>{le.getInstance().off("to."+t+".success",n),le.getInstance().off("to."+t+".error",s)},0),e(null,r)),s=r=>{new O(r);return window.setTimeout(()=>{le.getInstance().off("to."+t+".success",n),le.getInstance().off("to."+t+".error",s)},0),e(r,null)};return le.getInstance().on("to."+t+".success",n),le.getInstance().on("to."+t+".error",s),!0}updatePushNotificationPreference(e,t,n,s,r,a,o){this._updatePushNotificationPreference({doNotDisturb:e,startHour:t,startMin:n,endHour:s,endMin:r,timezone:a},o)}_updatePushNotificationPreference(e,t){let n={t:"users.push_preference_update",d:{dnd:e.doNotDisturb,start_dnd_hour:e.startHour,start_dnd_min:e.startMin,end_dnd_hour:e.endHour,end_dnd_min:e.endMin,timezone:e.timezone}};e.groupChannelId&&(n.d.group_channel_id=e.groupChannelId);let s=this.transportManager.send(n),r=()=>(window.setTimeout(()=>{le.getInstance().off("to."+s+".success",r),le.getInstance().off("to."+s+".error",a)},0),t(null)),a=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+s+".success",r),le.getInstance().off("to."+s+".error",a)},0),t(e)};return le.getInstance().on("to."+s+".success",r),le.getInstance().on("to."+s+".error",a),!0}getPushNotificationPreference(e){this._getPushNotificationPreference({},e)}_getPushNotificationPreference(e,t){let n={t:"users.push_preference_get",d:{}};e.groupChannelId&&(n.d.group_channel_id=e.groupChannelId);let s=this.transportManager.send(n),r=e=>(window.setTimeout(()=>{le.getInstance().off("to."+s+".success",r),le.getInstance().off("to."+s+".error",a)},0),t(null,e.dnd,e.start_dnd_hour,e.start_dnd_min,e.end_dnd_hour,e.end_dnd_min,e.timezone)),a=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+s+".success",r),le.getInstance().off("to."+s+".error",a)},0),t(e,null,null,null,null,null,null)};return le.getInstance().on("to."+s+".success",r),le.getInstance().on("to."+s+".error",a),!0}_updateDisplayNameOnServer(e,t){let n={id:this.user.id,display_name:e};return this._updateUserOnServer(n,t)}_updateProfileUrlOnServer(e,t){let n={id:this.user.id,profile_url:e};return this._updateUserOnServer(n,t)}_updateAvatarUrlOnServer(e,t){let n={id:this.user.id,avatar_url:e};return this._updateUserOnServer(n,t)}_updateMetadataOnServer(e,t){let n={id:this.user.id,metadata:e};return this._updateUserOnServer(n,t)}_updateUserOnServer(e,t){let n={t:"users.update",d:e},s=this.transportManager.send(n),r=e=>(window.setTimeout(()=>{le.getInstance().off("to."+s+".success",r),le.getInstance().off("to."+s+".error",a)},0),t(null,e)),a=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+s+".success",r),le.getInstance().off("to."+s+".error",a)},0),t(e,null)};return le.getInstance().on("to."+s+".success",r),le.getInstance().on("to."+s+".error",a),!0}markAsReadAll(e){let t=this.transportManager.send({t:"users.mark_as_read_all",d:{}}),n=()=>(window.setTimeout(()=>{le.getInstance().off("to."+t+".success",n),le.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new O(r);return window.setTimeout(()=>{le.getInstance().off("to."+t+".success",n),le.getInstance().off("to."+t+".error",s)},0),e(r)};return le.getInstance().on("to."+t+".success",n),le.getInstance().on("to."+t+".error",s),!0}getTotalUnreadMessageCount(e,t){"object"==typeof t?this._getTotalUnreadMessageCount(e,t):this._getTotalUnreadMessageCount(new H,e)}_getTotalUnreadMessageCount(e,t){let n={custom_filter_query_type:e.getCustomFilterQueryType()};e.getCustomFilter().length&&(n.custom_filter=e.getCustomFilter());let s=this.transportManager.send({t:"users.get_total_unread_message_count",d:n}),r=n=>{let o=e.getCustomFilter().join("")+e.getCustomFilterQueryType();return this.cachedTotalUnreadMessageCount[o]={count:n,params:e},window.setTimeout(()=>{le.getInstance().off("to."+s+".success",r),le.getInstance().off("to."+s+".error",a)},0),t(null,n,e)},a=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+s+".success",r),le.getInstance().off("to."+s+".error",a)},0),t(e,null,null)};return le.getInstance().on("to."+s+".success",r),le.getInstance().on("to."+s+".error",a),!0}getTotalUnreadGroupChannelCount(e,t){"object"==typeof t?this._getTotalUnreadGroupChannelCount(e,t):this._getTotalUnreadGroupChannelCount(new H,e)}_getTotalUnreadGroupChannelCount(e,t){let n={custom_filter_query_type:e.getCustomFilterQueryType()};e.getCustomFilter().length&&(n.custom_filter=e.getCustomFilter());let s=this.transportManager.send({t:"users.get_total_unread_group_channel_count",d:n}),r=n=>{let o=e.getCustomFilter().join("")+e.getCustomFilterQueryType();return this.cachedTotalUnreadGroupChannelCount[o]={count:n,params:e},window.setTimeout(()=>{le.getInstance().off("to."+s+".success",r),le.getInstance().off("to."+s+".error",a)},0),t(null,n,e)},a=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+s+".success",r),le.getInstance().off("to."+s+".error",a)},0),t(e,null,null)};return le.getInstance().on("to."+s+".success",r),le.getInstance().on("to."+s+".error",a),!0}updatePushNotificationSnooze(e,t){Math.round((new Date).getTime()/1e3);let n=this.transportManager.send({t:"users.push_notification_snooze_update",d:{push_notification_snooze_duration:e}}),s=()=>(window.setTimeout(()=>{le.getInstance().off("to."+n+".success",s),le.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+n+".success",s),le.getInstance().off("to."+n+".error",r)},0),t(e)};return le.getInstance().on("to."+n+".success",s),le.getInstance().on("to."+n+".error",r),!0}getPushNotificationSnooze(e){let t=this.transportManager.send({t:"users.push_notification_snooze_get",d:{}}),n=r=>{let a=Math.round((new Date).getTime()/1e3),o=0;return r-a>0&&(o=Math.round((r-a)/60)),window.setTimeout(()=>{le.getInstance().off("to."+t+".success",n),le.getInstance().off("to."+t+".error",s)},0),e(null,o)},s=r=>{new O(r);return window.setTimeout(()=>{le.getInstance().off("to."+t+".success",n),le.getInstance().off("to."+t+".error",s)},0),e(r,null)};return le.getInstance().on("to."+t+".success",n),le.getInstance().on("to."+t+".error",s),!0}updateUserPushToken(e,t,n){let s={push_token_type:t,push_token:e},r=this.transportManager.send({t:"users.push_token_update",d:s}),a=e=>(window.setTimeout(()=>{le.getInstance().off("to."+r+".success",a),le.getInstance().off("to."+r+".error",o)},0),n(null,e)),o=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+r+".success",a),le.getInstance().off("to."+r+".error",o)},0),n(e,null)};return le.getInstance().on("to."+r+".success",a),le.getInstance().on("to."+r+".error",o),!0}deleteUserPushToken(e,t,n){this._deleteUserPushTokenOnServer(e,t,n)}deleteAllUserPushTokens(e){this._deleteUserPushTokenOnServer(e)}_deleteUserPushTokenOnServer(e,t,n){let s={},r=e;"function"==typeof n&&(s={push_token_type:t,push_token:e},r=n);let a=this.transportManager.send({t:"users.push_token_delete",d:s}),o=()=>(window.setTimeout(()=>{le.getInstance().off("to."+a+".success",o),le.getInstance().off("to."+a+".error",i)},0),r(null)),i=e=>{new O(e);return window.setTimeout(()=>{le.getInstance().off("to."+a+".success",o),le.getInstance().off("to."+a+".error",i)},0),r(e)};return le.getInstance().on("to."+a+".success",o),le.getInstance().on("to."+a+".error",i),!0}getCurrentUser(){return this.user}}var he=t.default=le}])});